

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modelling of physical phenomena in SPPS &mdash; I-Simpa 1.3.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Presentation" href="code_TCR.html" />
    <link rel="prev" title="General principle" href="code_SPPS_principle.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> I-Simpa
          

          
          </a>

          
            
            
              <div class="version">
                1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">I-Simpa Presentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="I_Simpa_overview.html">I-Simpa overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="I_Simpa_overview.html#i-simpa-features">I-Simpa features</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial_teaching_room.html">Study of a teaching room</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_Elmia_hall.html">Study of the Elmia hall</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_industrial_hall.html">Study of an industrial room</a></li>
</ul>
<p class="caption"><span class="caption-text">I-Simpa User Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="setup.html">(Un)Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation.html">GUI Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="menus.html">Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="toolbars.html">Toolbars</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_window.html">‘Project’ window</a></li>
<li class="toctree-l1"><a class="reference internal" href="properties_window.html">‘Properties’ window</a></li>
<li class="toctree-l1"><a class="reference internal" href="console_window.html">‘Console’ window</a></li>
<li class="toctree-l1"><a class="reference internal" href="main_windows.html">‘Main’ window</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_database.html">Project database</a></li>
</ul>
<p class="caption"><span class="caption-text">Thematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="import_options.html">Import options</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_file_recommandations.html">Recommendations to import a 3D scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_spectrum.html">Define and use spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="define_position.html">Define a position using the pointer on the 3D view</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface_selection.html">Surface selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulate_sources_receivers.html">Manipulating sources and receivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_directivity.html">Using directivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_charts.html">Creating charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_charts.html#chart-options">Chart Options</a></li>
</ul>
<p class="caption"><span class="caption-text">SPPS Code</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="code_SPPS.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_configuration_SPPS.html">Using SPPS within I-Simpa</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_SPPS_principle.html">General principle</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modelling of physical phenomena in <strong>SPPS</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sound-source-modelling">Sound source modelling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-formalism">General formalism</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#acoustic-directivity-and-probability-density-of-sound-particles-emission">Acoustic directivity and probability density of sound particles emission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#source-power-and-elementary-particle-energy">Source power and elementary particle energy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#omnidirectionnal-source">Omnidirectionnal source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#physical-description">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modeling">Modeling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unidirectional-source">Unidirectional source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelling">Modelling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plane-sources-xy-yz-and-xz">Plane sources (XY, YZ and XZ)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Modelling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#acoustic-propagation-modelling">Acoustic propagation modelling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#acoustic-propagation">Acoustic propagation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Modeling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#atmospheric-absorption">Atmospheric absorption</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#random-modelling">Random modelling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#energetic-modelling">Energetic modelling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#acoustic-velocity-profile">Acoustic velocity profile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acoustic-velocity-profile-model">Acoustic velocity profile model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Modelling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#diffusion-by-fittings">Diffusion by fittings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21">Modelling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wall-modelling">Wall modelling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id22">Physical description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#absorption-dissipation-and-acoustic-transmission">Absorption, dissipation and acoustic transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acoustic-diffusion">Acoustic diffusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#acoustic-reflection-modelling">Acoustic reflection modelling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id26">Random modelling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">Energetic modelling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modelling-of-the-reflection-laws">Modelling of the reflection laws</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#formalism">Formalism</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specular-reflection">Specular reflection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uniform-reflection">Uniform reflection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lambert-reflection">Lambert reflection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#normal-reflection-w-n">Normal reflection <span class="math notranslate nohighlight">\(w^n\)</span></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#acoustic-transmission-modelling">Acoustic transmission modelling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id45">Physical description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id46">Random modelling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id47">Energetic modelling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#verification-of-wall-modelling">Verification of wall modelling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#calculation-of-sound-levels-at-observation-points">Calculation of sound levels at observation points</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-the-sound-pressure-level-at-a-volume-receiver">Calculation of the sound pressure level at a volume receiver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#intensity-vector-at-a-volume-receiver">Intensity vector at a volume receiver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-the-lateral-sound-pressure-level-at-a-volume-receiver">Calculation of the lateral sound pressure level at a volume receiver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-the-sound-intensity-level-on-a-surface-receiver">Calculation of the sound intensity level on a surface receiver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-the-sound-pressure-level-on-a-surface-receiver">Calculation of the sound pressure level on a surface receiver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-the-overall-sound-pressure-level-in-the-model">Calculation of the overall sound pressure level in the model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">TCR Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="code_TCR.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_configuration_TCR.html">Using TCR within I-Simpa</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="I_Simpa_standard.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">I-Simpa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Modelling of physical phenomena in <strong>SPPS</strong></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/code_SPPS_modelling.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="modelling-of-physical-phenomena-in-spps">
<h1>Modelling of physical phenomena in <strong>SPPS</strong><a class="headerlink" href="#modelling-of-physical-phenomena-in-spps" title="Permalink to this headline">¶</a></h1>
<div class="section" id="sound-source-modelling">
<h2>Sound source modelling<a class="headerlink" href="#sound-source-modelling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-formalism">
<h3>General formalism<a class="headerlink" href="#general-formalism" title="Permalink to this headline">¶</a></h3>
<div class="section" id="acoustic-directivity-and-probability-density-of-sound-particles-emission">
<h4>Acoustic directivity and probability density of sound particles emission<a class="headerlink" href="#acoustic-directivity-and-probability-density-of-sound-particles-emission" title="Permalink to this headline">¶</a></h4>
<p>From a numerical modelling point of view, the problem of sound emission from a point source is to attribute to the sound particles, at a given moment (which can be the origin of time), the exact position of the source, propagation directions in accordance with the directivity of the source. For example, in the case of an omnidirectional sound source, it is necessary to verify that the sound particles, once emitted, are uniformly distributed over a sphere centred on the source (see corresponding figure: <a class="reference internal" href="#geo-source"><span class="std std-ref">Elementary geometry for a sound source</span></a>). The first solution that comes to mind is to make a deterministic discretization of the source’s radiation in spherical coordinates; the method would consist in considering emission angles <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> by constant steps. Nevertheless, such discretization of emission angles causes an artificial concentration of sound particles at the poles of the sphere symbolizing the source.</p>
<div class="figure align-center" id="id48">
<span id="geo-source"></span><a class="reference internal image-reference" href="_images/geo_source.png"><img alt="Elementary geometry for a sound source" src="_images/geo_source.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Elementary geometry for a sound source</span></p>
<div class="legend">
The direction of emission of a particle is defined in spherical coordinates by the angles <span class="math notranslate nohighlight">\(\phi\)</span> (azimuth) between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2\pi\)</span>, and <span class="math notranslate nohighlight">\(\theta\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> (polar angle), or by the elementary solid angle <span class="math notranslate nohighlight">\(d\Omega\)</span>.</div>
</div>
<p>It is in fact necessary to check the respect of the number of particles emitted by elementary solid angle <span class="math notranslate nohighlight">\(d\Omega = d\phi\,\sin\theta\,d\theta\)</span>, checks the directivity of the source, either in a deterministic or random way (figure[geo_source]). In our case, we chose a random draw of the initial directions of the particles. It is then necessary to define the probability densities <span class="math notranslate nohighlight">\(g(\phi)\)</span> and <span class="math notranslate nohighlight">\(p(\theta)\)</span>, respectively for the angles <span class="math notranslate nohighlight">\(\phi\in[0.2\pi]\)</span> and <span class="math notranslate nohighlight">\(\theta\in[0.\pi]\)</span>, such as the probability density <span class="math notranslate nohighlight">\(Q(\theta,\phi)\)</span> of emission in the direction <span class="math notranslate nohighlight">\((\theta,\phi)\)</span> (or probability density <span class="math notranslate nohighlight">\(F(\Omega)\)</span> of emission in the elementary solid angle <span class="math notranslate nohighlight">\(\Omega\)</span>) either in accordance with the directivity of the source. In practice, <span class="math notranslate nohighlight">\(Q(\theta,\phi)\)</span> is nothing more than the directivity of the source. By definition, these probability densities verify the following relationship:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
        \int F(\Omega)\, d\Omega &amp;= \iint Q(\theta,\phi) \,\sin\theta \, d\phi\,d\theta \\
        &amp;=\int_{0}^{2\pi} g(\phi) \, d\phi \int_{0}^{\pi} p(\theta)\,\sin\theta\,d\theta\\
        &amp;=1.
        \end{aligned}\end{split}\]</div>
<p>From the point of view of sound power, this is equivalent to considering that the power <span class="math notranslate nohighlight">\(W\)</span> of the source is well distributed over the surface of a sphere centered on the source:</p>
<div class="math notranslate nohighlight">
\[\iint W\,Q(\theta,\phi) \,\sin\theta \, d\phi\,d\theta=W.\]</div>
<p>If the densities <span class="math notranslate nohighlight">\(g(\phi)\)</span> and <span class="math notranslate nohighlight">\(p(\theta)\)</span> are independent, they check:</p>
<div class="math notranslate nohighlight" id="equation-cond-g">
<span class="eqno">(1)<a class="headerlink" href="#equation-cond-g" title="Permalink to this equation">¶</a></span>\[\label{cond_g} \int_{0}^{2\pi} g(\phi) \, d\phi = 1,\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-cond-p">
<span class="eqno">(2)<a class="headerlink" href="#equation-cond-p" title="Permalink to this equation">¶</a></span>\[\label{cond_p} \int_{0}^{\pi} p(\theta)\,\sin\phi\,d\theta=1.\]</div>
</div>
<div class="section" id="source-power-and-elementary-particle-energy">
<h4>Source power and elementary particle energy<a class="headerlink" href="#source-power-and-elementary-particle-energy" title="Permalink to this headline">¶</a></h4>
<p>Acoustically, for a period of time <span class="math notranslate nohighlight">\(\Delta t\)</span>, a power source <span class="math notranslate nohighlight">\(W\)</span> emits an amount of energy <span class="math notranslate nohighlight">\(E=W\times \Delta t\)</span>. From a particle concept point of view, each particle carries an elementary energy <span class="math notranslate nohighlight">\(\varepsilon_0\)</span>. If the source emits <span class="math notranslate nohighlight">\(N\)</span> sound particles, the energy conservation between the two approaches therefore requires:</p>
<div class="math notranslate nohighlight">
\[N \times \varepsilon_0 = W\times \Delta t,\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\label{energie_elementaire} \varepsilon_0 = \frac{W}{N}\times \Delta t.\]</div>
</div>
</div>
<div class="section" id="omnidirectionnal-source">
<h3>Omnidirectionnal source<a class="headerlink" href="#omnidirectionnal-source" title="Permalink to this headline">¶</a></h3>
<div class="section" id="physical-description">
<h4>Physical description<a class="headerlink" href="#physical-description" title="Permalink to this headline">¶</a></h4>
<p>An omnidirectional sound source is a source that radiates in all directions with the same amplitude. The directivity of the source is similar to a sphere. The directivity coefficient <span class="math notranslate nohighlight">\(Q\)</span> associated with the directivity of the source is equal to <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
<div class="section" id="modeling">
<h4>Modeling<a class="headerlink" href="#modeling" title="Permalink to this headline">¶</a></h4>
<p>In the case of an omnidirectional source, the densities <span class="math notranslate nohighlight">\(g(\phi)\)</span> and <span class="math notranslate nohighlight">\(p(\theta)\)</span> being uniform, the relationships <a class="reference internal" href="#equation-cond-g">(1)</a> and <a class="reference internal" href="#equation-cond-p">(2)</a> verify:</p>
<div class="math notranslate nohighlight">
\[\int_{0}^{2\pi} g(\phi) \, d\phi =\int_{0}^{2\pi} A \, d\phi = 1\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\int_{0}^{\pi} p(\theta)\,\sin\theta\,d\theta=\int_{0}^{\pi} B\,\sin\theta\,d\theta=1,\]</div>
<p>where <span class="math notranslate nohighlight">\(A=1/2\pi\)</span> and <span class="math notranslate nohighlight">\(B=1/2\)</span> are two normalization constants. In practice, the method consists first of drawing an angle <span class="math notranslate nohighlight">\(\theta\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2\pi\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\label{choix_phi} \phi=2\pi \times u \quad \in [0,2\pi]\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is a random number between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, and defined by a uniform distribution. If the angle <span class="math notranslate nohighlight">\(\theta\)</span> is chosen in the same way (<em>i.e.</em> <span class="math notranslate nohighlight">\(\theta= \pi \times v\)</span>, <span class="math notranslate nohighlight">\(v\)</span> being a random number with a uniform distribution between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>), the distribution of the emission directions does not respect the elementary solid angle consistency, since the condition ([cond_p]) is not verified. In this case, the directions around the poles would be preferred. It is actually necessary to determine the angles <span class="math notranslate nohighlight">\(\theta\)</span> which verify a distribution proportional to <span class="math notranslate nohighlight">\(\sin\theta\)</span>. In this simple case, the procedure consists in applying the inverse cumulative distribution function method. According to the relationship <a class="reference internal" href="#equation-cond-p">(2)</a>, the probability <span class="math notranslate nohighlight">\(f(\hat{\theta})\)</span> of drawing an angle <span class="math notranslate nohighlight">\(\theta&lt;\hat{\theta}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\label{cdf_dist_theta} f(\hat{\theta}) = \frac{1}{2} \int_{0}^{\hat{\theta}} \sin\theta \, d\theta=\frac{1}{2} \left[\cos\hat{\theta}-1\right].\]</div>
<p>Knowing that this distribution is between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, the choice of the angle <span class="math notranslate nohighlight">\(hat{\theta}\)</span> is made by randomly drawing a number <span class="math notranslate nohighlight">\(v\in[0.1]\)</span>, following a uniform distribution, such as:</p>
<div class="math notranslate nohighlight">
\[\hat{\theta} = \cos^{-1} \left(2v-1\right)\quad \in [0,\pi].\]</div>
<p>The propagation vectors <span class="math notranslate nohighlight">\(\mathbf{v}(v_x,v_y,v_z)\)</span>, of standard <span class="math notranslate nohighlight">\(c\)</span> (sound velocity), are then defined by the relationships:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{v}=\left\{\begin{array}{l}
            v_x=c\,\cos\theta\,\sin\phi\\
            v_y=c\,\sin\theta\,\sin\phi\\
            v_z=c\,\cos\phi
            \end{array}\right.\end{split}\]</div>
</div>
<div class="section" id="verification">
<h4>Verification<a class="headerlink" href="#verification" title="Permalink to this headline">¶</a></h4>
<p>The figures <a class="reference internal" href="#dist-angles-phi-2019"><span class="std std-ref">Distribution of emission angles \phi for an omnidirectional source</span></a> and <a class="reference internal" href="#dist-angles-theta-2019"><span class="std std-ref">Distribution of emission angles \theta for an omnidirectional source</span></a> shows an example of the distribution of angles <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> obtained according to this printing method with <span class="math notranslate nohighlight">\(10000\)</span> achievements. It is easy to see that the angle distribution checks the theoretical distribution. It is understood that the quality of the random draw depends on the method of generating random numbers, and that compliance with theoretical distributions increases with the number of draws.</p>
<div class="figure align-center" id="id49">
<span id="dist-angles-phi-2019"></span><a class="reference internal image-reference" href="_images/Dist_angles_phi_2019.png"><img alt="Distribution of emission angles for an omnidirectional source." src="_images/Dist_angles_phi_2019.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Distribution of emission angles <span class="math notranslate nohighlight">\(\phi\)</span> for an omnidirectional source</span></p>
</div>
<div class="figure align-center" id="id50">
<span id="dist-angles-theta-2019"></span><a class="reference internal image-reference" href="_images/Dist_angles_theta_2019.png"><img alt="Distribution of emission angles for an omnidirectional source." src="_images/Dist_angles_theta_2019.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Distribution of emission angles <span class="math notranslate nohighlight">\(\theta\)</span> for an omnidirectional source</span></p>
</div>
</div>
</div>
<div class="section" id="unidirectional-source">
<h3>Unidirectional source<a class="headerlink" href="#unidirectional-source" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4>Physical description<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>A unidirectional sound source is a source that radiates in a single direction of space, defined by the angles <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, at the point of emission and in the absolute reference point. The directivity coefficient associated with the directivity of the source is then defined by:</p>
<div class="math notranslate nohighlight">
\[Q\left(\theta,\phi\right)=\delta\left(\theta,\phi\right)=\delta\left(\theta\right)\times\delta\left(\phi\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is the Dirac distribution funtion.</p>
</div>
<div class="section" id="modelling">
<h4>Modelling<a class="headerlink" href="#modelling" title="Permalink to this headline">¶</a></h4>
<p>The modelling of this type of source is entirely deterministic and therefore does not pose a problem. It is enough to define a vector <span class="math notranslate nohighlight">\(\mathbf{s}(s_x,s_y,s_z)\)</span> in the absolute reference frame of the scene, such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{s}=\left\{\begin{array}{l}
            s_x=s\,\cos\theta\,\sin\phi\\
            s_y=s\,\sin\theta\,\sin\phi\\
            s_z=s\,\cos\phi
            \end{array}\right.\end{split}\]</div>
</div>
</div>
<div class="section" id="plane-sources-xy-yz-and-xz">
<h3>Plane sources (XY, YZ and XZ)<a class="headerlink" href="#plane-sources-xy-yz-and-xz" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id2">
<h4>Physical description<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>A ‘plane’ type sound source is a source that radiates in a plane. By default, we consider three sources XY, YZ and XZ defined by the three reference planes <span class="math notranslate nohighlight">\((xOy)\)</span>, <span class="math notranslate nohighlight">\((yOz)\)</span> and <span class="math notranslate nohighlight">\((xOz)\)</span> respectively.</p>
</div>
<div class="section" id="id3">
<h4>Modelling<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>The procedure consists in randomly determining the direction of propagation of a particle in a plane. Using the angle convention presented in figure <a class="reference internal" href="#geo-source"><span class="std std-ref">Elementary geometry for a sound source</span></a>, we will have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{\begin{array}{llll}
            \text{XY plane:}&amp; \theta=2\pi \times u\quad &amp;\text{and}&amp;\quad \phi=\pi/2\\
            \text{YZ plane:}&amp; \theta=0 \quad &amp;\text{and}&amp;\quad \phi=2\pi \times u\\
            \text{XZ plane:}&amp; \theta=\pi/2\quad &amp;\text{and}&amp;\quad \phi=2\pi \times u
            \end{array}\right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> refers to a random number between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>. Thereafter, the propagation vector <span class="math notranslate nohighlight">\(\mathbf{v}(v_x,v_y,v_y,v_z)\)</span>, of standard <span class="math notranslate nohighlight">\(c\)</span> (sound velocity), is defined by the relationships:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{v}=\left\{\begin{array}{l}
            v_x=c\,\cos\theta\,\sin\phi\\
            v_y=c\,\sin\theta\,\sin\phi\\
            v_z=c\,\cos\phi
            \end{array}\right.\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="acoustic-propagation-modelling">
<h2>Acoustic propagation modelling<a class="headerlink" href="#acoustic-propagation-modelling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="acoustic-propagation">
<h3>Acoustic propagation<a class="headerlink" href="#acoustic-propagation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id4">
<h4>Physical description<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>In the absence of absorption and reflection on the walls of the domain or on objects, the decrease in sound intensity from an omnidirectional source is written:</p>
<div class="math notranslate nohighlight">
\[I=\frac{Q}{4\pi\,r^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the distance to the source, and <span class="math notranslate nohighlight">\(Q\)</span> is the directivity of the source in the direction of observation (<span class="math notranslate nohighlight">\(Q=1\)</span> for an omnidirectional source). This decrease reflects the phenomenon of geometric dispersion, which describes the “spreading” of a spherical wave as it propagates.</p>
</div>
<div class="section" id="id5">
<h4>Modeling<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Considering the method presented for an omnidirectional source, the geometric dispersion is automatically respected. Indeed, the proposed numerical method allows to obtain a uniform distribution of particles over an elementary solid angle. On a sphere, the particle distribution <span class="math notranslate nohighlight">\(n(r)\)</span> (in <span class="math notranslate nohighlight">\(m^2\)</span>) is therefore equal to:</p>
<div class="math notranslate nohighlight">
\[n(r)=\frac{N}{4\pi\,r^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of particles. The particle distribution therefore verifies the same decrease as the intensity. It should be noted, however, that the further away the observation point is from the source, the more sound particles will be required.</p>
</div>
<div class="section" id="id6">
<h4>Verification<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The figure <a class="reference internal" href="#verif-dispersion"><span class="std std-ref">Verification of the respect of the geometric dispersion with the SPPS code</span></a> shows the numerical results of the free field propagation (the free field is simulated by considering a long corridor with perfectly absorbent limits), for an omnidirectional sound source, without atmospheric absorption (number of particles <span class="math notranslate nohighlight">\(N=20\times 10^6\)</span>). The agreement is excellent.</p>
<div class="figure align-center" id="id51">
<span id="verif-dispersion"></span><a class="reference internal image-reference" href="_images/fig_illustration_dispersion.png"><img alt="Distribution of emission angles for an omnidirectional source." src="_images/fig_illustration_dispersion.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Verification of the respect of the geometric dispersion with the SPPS code</span></p>
<div class="legend">
The numerical simulations are compared with the theoretical decrease (<span class="math notranslate nohighlight">\(N=20\times 10^6\)</span> particles). The marker presents the result of the simulation with the <strong>SPPS</strong> code. The solid line shows the theoretical geometric dispersion.</div>
</div>
</div>
</div>
<div class="section" id="atmospheric-absorption">
<h3>Atmospheric absorption<a class="headerlink" href="#atmospheric-absorption" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id7">
<h4>Physical description<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>During its propagation in air, a sound wave is partially attenuated by particular physical mechanisms (“classical” transmission processes, molecular absorption due to rotational relaxation, molecular absorption due to vibratory relaxation of oxygen and nitrogen) <a class="reference internal" href="references.html#bass1984" id="id8">[BSPE84]</a>. Thus, after a propagation distance <span class="math notranslate nohighlight">\(r\)</span>, the amplitude <span class="math notranslate nohighlight">\(p_t\)</span> of the sound pressure decreases according to the relationship (<a class="reference internal" href="I_Simpa_standard.html#term-iso-9613-1"><span class="xref std std-term">ISO 9613-1</span></a>):</p>
<div class="math notranslate nohighlight">
\[\label{eq:att_atmos_pression}
        p_t= p_i \exp \left(-\frac{\ln(10)}{20}\alpha_\text{air}\times r\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(p_i\)</span> is the initial pressure. Considering that the sound intensity is proportional to the square of the sound pressure,</p>
<div class="math notranslate nohighlight">
\[\label{eq:att_atmos_pression_I}
        I\propto p_t^2 \propto \exp \left(-2\frac{\ln(10)}{20}\alpha_\text{air}\times r\right)\]</div>
<p>and writing that the intensity <span class="math notranslate nohighlight">\(I\)</span> of the sound wave decreases with the relationship:</p>
<div class="math notranslate nohighlight" id="equation-att-atmos">
<span class="eqno">(3)<a class="headerlink" href="#equation-att-atmos" title="Permalink to this equation">¶</a></span>\[\label{eq:att_atmos}
        I= I_0 \exp -m\,r,\]</div>
<p>where <span class="math notranslate nohighlight">\(I_0\)</span> is the initial intensity of the sound wave. Then, the atmospheric absorption coefficient <span class="math notranslate nohighlight">\(m\)</span> (in Np/m) can be expressed from the atmospheric absorption coefficient <span class="math notranslate nohighlight">\(\alpha_\text{air}\)</span> (in dB/m), by the relationship:</p>
<div class="math notranslate nohighlight">
\[m=\frac{\ln 10}{10}\alpha_\text{air}.\]</div>
<p>In <strong>SPPS</strong> code, the atmospheric absorption coefficient <span class="math notranslate nohighlight">\(\alpha_{air}\)</span> is calculated according to <a class="reference internal" href="I_Simpa_standard.html#term-iso-9613-1"><span class="xref std std-term">ISO 9613-1</span></a>, considering the centre frequency of each frequency band of calculation according to the reference standard (<em>cf.</em> paragraph 8.2.1 of <a class="reference internal" href="I_Simpa_standard.html#term-iso-9613-1"><span class="xref std std-term">ISO 9613-1</span></a>). This approximation is considered valid if the product of the source-receiver distance (in km) by the square of the centre frequency (in kHz) does not exceed 6 km.kHz <span class="math notranslate nohighlight">\(^2\)</span> for the third octave bands and 3 km.kHz <span class="math notranslate nohighlight">\(^2\)</span> for the octave bands. However, the propagation distance must not exceed 6 km for third octave bands and 3 km for octave bands, regardless of the centre frequency considered.</p>
</div>
<div class="section" id="random-modelling">
<h4>Random modelling<a class="headerlink" href="#random-modelling" title="Permalink to this headline">¶</a></h4>
<p>By choosing the ‘random’ calculation mode, atmospheric absorption is taken into account as a probability of the sound particle disappearing during its displacement. The corresponding probability density can be defined from the relationship <a class="reference internal" href="#equation-att-atmos">(3)</a>:</p>
<div class="math notranslate nohighlight">
\[f(r)=\exp -m\,r.\]</div>
<p>This quantity expresses the probability that the particle will not be absorbed during its propagation distance <span class="math notranslate nohighlight">\(r\)</span>. The probability density <span class="math notranslate nohighlight">\(f(r)\)</span> is well between <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(0\)</span> (see figure <a class="reference internal" href="#geo-att-atmos"><span class="std std-ref">Modelling of atmospheric absorption by a random process</span></a>):</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(f(0)=1\)</span>, the probability is maximum, the particle cannot be absorbed if it does not move;</li>
<li><span class="math notranslate nohighlight">\(f(\infty)=0\)</span>, the probability is zero since the particle cannot spread infinitely.</li>
</ul>
<p>It is also easily verified that the probability of propagation is independent of the previous probability of propagation:</p>
<div class="math notranslate nohighlight">
\[f\left(\Sigma_{n=1}^N r_i\right)=\Pi_{i=1}^N f(r_n).\]</div>
<p>Taking atmospheric absorption into account is relatively simple. It is sufficient to consider a uniform random number <span class="math notranslate nohighlight">\(\zeta\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, at each time step, and to compare this number to the probability density <span class="math notranslate nohighlight">\(f(d_0)\)</span> corresponding to an elementary displacement <span class="math notranslate nohighlight">\(d_O=c\Delta t\)</span> on a time step <span class="math notranslate nohighlight">\(\Delta t\)</span>. If this number <span class="math notranslate nohighlight">\(\zeta\)</span> is less than <span class="math notranslate nohighlight">\(f(d_o)\)</span>, there will be propagation. Otherwise, there will be atmospheric absorption, thus disappearing the particle. Even on a small number of particles, this method makes it possible to correctly take into account atmospheric absorption.</p>
<div class="figure align-center" id="id52">
<span id="geo-att-atmos"></span><a class="reference internal image-reference" href="_images/geo_att_atmos.png"><img alt="Modelling of atmospheric absorption by a random process." src="_images/geo_att_atmos.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Modelling of atmospheric absorption by a random process</span></p>
<div class="legend">
The curve <span class="math notranslate nohighlight">\(f(r)\)</span> separates the propagation domain from the atmospheric absorption domain.</div>
</div>
</div>
<div class="section" id="energetic-modelling">
<h4>Energetic modelling<a class="headerlink" href="#energetic-modelling" title="Permalink to this headline">¶</a></h4>
<p>By choosing the ‘energetic’ calculation option, the energy of the particle is weighted throughout its movement, using the relationship <a class="reference internal" href="#equation-att-atmos">(3)</a>.</p>
</div>
<div class="section" id="id9">
<h4>Verification<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>As an illustration, the figure <a class="reference internal" href="#illustration-att-atmos"><span class="std std-ref">Illustration of the modelling of atmospheric absorption in the SPPS code</span></a> shows the sound decrease calculated by the <strong>SPPS</strong> code at <span class="math notranslate nohighlight">\(10\)</span> kHz for classical atmospheric conditions (<span class="math notranslate nohighlight">\(T=20\)</span> Celsisus, <span class="math notranslate nohighlight">\(H=50\)</span> %, <span class="math notranslate nohighlight">\(P=101325\)</span> Pa, or <span class="math notranslate nohighlight">\(m=0.036\)</span> m <span class="math notranslate nohighlight">\(^{-1}\)</span>), for both types of modelling, compared to the theoretical decrease presented to the relationship <a class="reference internal" href="#equation-att-atmos">(3)</a>; the simulation is identical to the one for the verification of the respect of the geometric dispersion.. As expected, energetic modelling gives a better result than random modelling, the average deviation from the theoretical curve being <span class="math notranslate nohighlight">\(0.17\)</span> dB and <span class="math notranslate nohighlight">\(0.41\)</span> dB respectively, the calculation times being similar.</p>
<div class="figure align-center" id="id53">
<span id="illustration-att-atmos"></span><a class="reference internal image-reference" href="_images/illustration_att_atmos.png"><img alt="Illustration of the modelling of atmospheric absorption in the SPPS code." src="_images/illustration_att_atmos.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Illustration of the modelling of atmospheric absorption in the SPPS code</span></p>
<div class="legend">
Comparison with the theoretical decrease (with et without atmospheric absorption) Simulations performed with (<span class="math notranslate nohighlight">\(N=20\times 10^6\)</span> particles) at 10 kHz, for conventional atmospheric conditions: <span class="math notranslate nohighlight">\(T=20\)</span> Celsisus, <span class="math notranslate nohighlight">\(H=50\)</span> %, <span class="math notranslate nohighlight">\(P=101325\)</span> Pa, or <span class="math notranslate nohighlight">\(m=0.036\)</span> m <span class="math notranslate nohighlight">\(^{-1}\)</span>.</div>
</div>
</div>
</div>
<div class="section" id="acoustic-velocity-profile">
<h3>Acoustic velocity profile<a class="headerlink" href="#acoustic-velocity-profile" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id10">
<h4>Physical description<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>In outdoor environments, acoustic propagation can be influenced by micrometeorological conditions governed by thermal (heat transfer) and aerodynamic (wind profiles) laws. The phenomena have a very strong interaction with the ground (topography, surface and subsoil temperature, hygrometry, crops, forests, obstacles, buildings, etc.). In addition, they evolve rapidly in time and space, making their analytical description and numerical modelling complex. The thermal and aerodynamic factors that influence propagation are as follows:</p>
<blockquote>
<div><ul class="simple">
<li>Thermal factors: heat exchanges between the ground and the lower layer of the atmosphere lead to a variation in air temperature as a function of the height above the ground, and therefore to a variation in sound velocity.</li>
<li>Aerodynamic factors: due to the roughness of the ground surface, wind speed is always higher at height than at ground level. In a given situation, the speed of sound in the presence of wind corresponds to the algebraic sum of the speed of sound in the absence of wind and the projection of the wind vector on the direction of propagation considered. This speed therefore varies according to the height above the ground.</li>
</ul>
</div></blockquote>
<p>By analogy with the laws of optics (see figure <a class="reference internal" href="#geo-profil-celerite"><span class="std std-ref">Schematic representation of the acoustic refraction in the atmosphere in the presence of a vertical velocity profile</span></a>), the effect of atmospheric conditions on acoustic propagation can be described through the expression of the acoustic index <span class="math notranslate nohighlight">\(n\)</span> of the propagation medium. If placed in a vertical section, this index is assumed to vary with altitude <span class="math notranslate nohighlight">\(z\)</span> and with source-receptor distance <span class="math notranslate nohighlight">\(r\)</span>, such that:</p>
<div class="math notranslate nohighlight">
\[n(r,z)=\frac{c(r,z)}{c_0}=\langle n(r,z)\rangle + \mu(r,z),\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> the reference one. Thus, two distinct phenomena can be distinguished that affect acoustic propagation, refraction and atmospheric turbulence. These phenomena are respectively related to the deterministic parts <span class="math notranslate nohighlight">\(\langle n\rangle\)</span> and stochastic <span class="math notranslate nohighlight">\(\mu\)</span> of the propagation medium index. In practice, these refraction and turbulence phenomena co-exist and interact, leading to complex propagation conditions, as well as a very wide dispersion of the sound levels encountered <em>in situ</em>, all of which are identical (topography, soil type, source-receptor geometry, etc.).</p>
<div class="figure align-center" id="id54">
<span id="geo-profil-celerite"></span><a class="reference internal image-reference" href="_images/geo_profil_celerite.png"><img alt="Schematic representation of the acoustic refraction in the atmosphere in the presence of a vertical velocity profile." src="_images/geo_profil_celerite.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Schematic representation of the acoustic refraction in the atmosphere in the presence of a vertical velocity profile</span></p>
</div>
</div>
<div class="section" id="acoustic-velocity-profile-model">
<h4>Acoustic velocity profile model<a class="headerlink" href="#acoustic-velocity-profile-model" title="Permalink to this headline">¶</a></h4>
<p>The average sound velocity profile thus depends on the average wind and temperature profiles. This velocity profile can be described analytically, depending on whether it follows a linear (“<span class="math notranslate nohighlight">\(\text{lin}\)</span>”), logarithmic (“<span class="math notranslate nohighlight">\(\text{log}\)</span>”), hybrid (“<span class="math notranslate nohighlight">\(\text{log-lin}\)</span>”) or other law. The “<span class="math notranslate nohighlight">\(\text{log}\)</span>” profiles thus have the advantage of translating the very strong vertical gradient of sound velocity in the immediate vicinity of the ground, but do not accurately reflect the more moderate evolution with altitude above a certain height. On the other hand, the “<span class="math notranslate nohighlight">\(\text{lin}\)</span>” profile minimizes the effects in the vicinity of the ground and are therefore not representative of reality when placed at very low altitude. A good compromise therefore consists in using hybrid profiles of the type “<span class="math notranslate nohighlight">\(\text{log-lin}\)</span>” (valid especially for a so-called “stable” atmosphere), expressed through the parameters <span class="math notranslate nohighlight">\(a_\text{log}\)</span> and <span class="math notranslate nohighlight">\(b_\text{lin}\)</span> which appear in the analytical expression of the vertical profile of the effective sound velocity:</p>
<div class="math notranslate nohighlight" id="equation-celerite-log-lin">
<span class="eqno">(4)<a class="headerlink" href="#equation-celerite-log-lin" title="Permalink to this equation">¶</a></span>\[\label{eq:celerite_log_lin}
        \langle c(z)\rangle=c_0+ a_\text{log}\times \ln\left(1+\frac{z}{z_0}\right)+b_\text{lin}\times \left( z-z_0\right),\]</div>
<p>où <span class="math notranslate nohighlight">\(z_0\)</span> is the roughness parameter, whose typical values range from <span class="math notranslate nohighlight">\(10^{-2}\)</span> m for short grass to several meters in urban areas. The vertical gradient is then expressed by deriving according to the variable <span class="math notranslate nohighlight">\(z\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\langle c(z)\rangle}{\partial z}=\frac{a_\text{log}}{z_0}+b_\text{lin}.\]</div>
<p>The main effect of propagation in a medium of variable speed is to bend the sound rays downwards or upwards depending on whether the vertical gradient of sound velocity is positive (<em>conditions (very) favorable</em> to propagation) or negative (<em>conditions (very) unfavorable</em> to propagation) respectively. The transient state between these two states represents <em>homogeneous</em> propagation conditions.</p>
<blockquote>
<div><ul>
<li><p class="first"><strong>Homogeneous:</strong> the speed <span class="math notranslate nohighlight">\(c\)</span> is the same at any point in the domain and equal to the reference speed <span class="math notranslate nohighlight">\(c_0\)</span>, the latter being calculated as a function of temperature and humidity conditions by the formula:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[c_0=343.2\sqrt{\frac{T}{T_\text{ref}}},\]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the temperature (K), and <span class="math notranslate nohighlight">\(T_\text{ref}=293.15\)</span>&nbsp;K the reference temperature (<a class="reference internal" href="I_Simpa_standard.html#term-iso-9613-1"><span class="xref std std-term">ISO 9613-1</span></a>).</p>
</div></blockquote>
</li>
<li><p class="first"><strong>Very unfavorable</strong> : <span class="math notranslate nohighlight">\(a_\text{log}=-1\)</span> and <span class="math notranslate nohighlight">\(b_\text{lin}=-0.12\)</span>;</p>
</li>
<li><p class="first"><strong>Unfavorable</strong> : <span class="math notranslate nohighlight">\(a_\text{log}=-0.4\)</span> and <span class="math notranslate nohighlight">\(b_\text{lin}=-0.04\)</span>;</p>
</li>
<li><p class="first"><strong>Favorable</strong>: <span class="math notranslate nohighlight">\(a_\text{log}=+0.4\)</span> and <span class="math notranslate nohighlight">\(b_\text{lin}=+0.04\)</span>;</p>
</li>
<li><p class="first"><strong>Very favorable</strong>: <span class="math notranslate nohighlight">\(a_\text{log}=+1\)</span> and <span class="math notranslate nohighlight">\(b_\text{lin}=+0.12\)</span>.</p>
</li>
</ul>
</div></blockquote>
<p>The curvature of the radius, at the boundary of zones (I) and (II), is obtained by applying the Huygens-Fresnel construction, resulting in the following Snell-Descartes law <a class="reference internal" href="references.html#salomons2001" id="id11">[Sal01]</a> (see figure <a class="reference internal" href="#geo-profil-celerite"><span class="std std-ref">Schematic representation of the acoustic refraction in the atmosphere in the presence of a vertical velocity profile</span></a>):</p>
<div class="math notranslate nohighlight" id="equation-relation-snell">
<span class="eqno">(5)<a class="headerlink" href="#equation-relation-snell" title="Permalink to this equation">¶</a></span>\[\label{relation_snell}
        \frac{\cos\gamma_1}{c_1}=\frac{\cos\gamma_2}{c_2},\]</div>
<p>where <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> are respectively the norms of the propagation vectors <span class="math notranslate nohighlight">\(\mathbf{c_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{c_2}\)</span>, and where the angles <span class="math notranslate nohighlight">\(\gamma_1\)</span> and <span class="math notranslate nohighlight">\(\gamma_2\)</span> are defined with respect to the horizontal axis in the plane <span class="math notranslate nohighlight">\((xOy)\)</span>. By construction, the projection of the propagation direction in the plane <span class="math notranslate nohighlight">\((xOy)\)</span>, defined by the angle <span class="math notranslate nohighlight">\(\phi\)</span> in spherical coordinates, is preserved.</p>
</div>
<div class="section" id="id12">
<h4>Modelling<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>Whatever the method of calculation chosen, the speed is taken into account is identical. At each time step, the speed standard is calculated according to the chosen speed profile, based on the relationship <a class="reference internal" href="#equation-celerite-log-lin">(4)</a>. To determine the new direction of propagation, due to the change in speed, the relationship <a class="reference internal" href="#equation-relation-snell">(5)</a> must then be applied. Knowing the angle <span class="math notranslate nohighlight">\(\theta_1\)</span> of the initial propagation direction, the new propagation direction is defined by:</p>
<div class="math notranslate nohighlight" id="equation-cosgamma2">
<span class="eqno">(6)<a class="headerlink" href="#equation-cosgamma2" title="Permalink to this equation">¶</a></span>\[\label{cosgamma2}
        \cos\gamma_2=\frac{c_2}{c_1}\cos\gamma_1=\frac{c_2}{c_1}\frac{\sqrt{c_{1x}^2+c_{1y}^2}}{c_1}.\]</div>
<p>The coordinates of the propagation vector are then obtained by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{c_2}=\left\{\begin{array}{l}
        c_{2x}=c_2\cos\gamma_2\cos\phi\\
        c_{2y}=c_2\cos\gamma_2\sin\phi\\
        c_{2z}=c_2\sin\gamma_2
        \end{array}\right.\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\sin\phi=\frac{c_{1y}}{\sqrt{c_{1x}^2+c_{1y}^2}},\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\cos\phi=\frac{c_{1x}}{\sqrt{c_{1x}^2+c_{1y}^2}}.\]</div>
<p>From a numerical simulation point of view, the calculation of <span class="math notranslate nohighlight">\(\cos\gamma_2\)</span> by the relationship <a class="reference internal" href="#equation-cosgamma2">(6)</a> can give values higher than <span class="math notranslate nohighlight">\(1\)</span> which is obviously not physical. This case occurs when the curvature (<em>turning point</em>) of a radius is reversed. To avoid this problem and impose a change in curvature, the procedure consists in imposing the value from <span class="math notranslate nohighlight">\(\gamma_2\)</span> to <span class="math notranslate nohighlight">\(1-\epsilon\)</span> (<span class="math notranslate nohighlight">\(\epsilon\)</span> being a very small value) and changing the orientation of the component <span class="math notranslate nohighlight">\(c_{2z}\)</span>.</p>
<p>As an example, the figure [illustration_refraction] shows two illustrations of how acoustic refraction is taken into account using this method. This figure can be compared directly with the examples given in the reference <a class="reference internal" href="references.html#salomons2001" id="id13">[Sal01]</a> (figures 4.5 and 4.6).</p>
<div class="figure align-center" id="id55">
<span id="illustration-refraction-downward"></span><a class="reference internal image-reference" href="_images/illustration_refraction_downward.png"><img alt="Illustration of the modelling of acoustic refraction with SPPS in downward condition." src="_images/illustration_refraction_downward.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Illustration of the modelling of acoustic refraction with SPPS in downward condition</span></p>
</div>
<div class="figure align-center" id="id56">
<span id="illustration-refraction-upward"></span><a class="reference internal image-reference" href="_images/illustration_refraction_upward.png"><img alt="Illustration of the modelling of acoustic refraction with SPPS in upward condition." src="_images/illustration_refraction_upward.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Illustration of the modelling of acoustic refraction with SPPS in upward condition</span></p>
</div>
</div>
</div>
<div class="section" id="diffusion-by-fittings">
<h3>Diffusion by fittings<a class="headerlink" href="#diffusion-by-fittings" title="Permalink to this headline">¶</a></h3>
<p>The presence of a large number of objects on the path of a sound wave can lead to a diffusion process. This process can be simulated in a deterministic way, by modelling each object individually. When the number of objects becomes large, and these objects are of similar sizes (example of an industrial hall with many machines (without acoustic emission) or similar boxes), it may be more interesting to statistically model this fitting zone.</p>
<div class="section" id="id14">
<h4>Physical description<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>In order to take into account the diffusion and absorption of diffusing (or scattering) objects distributed in the propagation medium, we considered an approach similar to that of Ondet and Barbry <a class="reference internal" href="references.html#ondet1989" id="id15">[OB89]</a>, which itself is based on the work of many authors <a class="reference internal" href="references.html#kuttruff1981" id="id16">[Kut81]</a><a class="reference internal" href="references.html#auletta1985" id="id17">[Aul85]</a><a class="reference internal" href="references.html#auletta1986" id="id18">[Aul86]</a><a class="reference internal" href="references.html#lindqvist1982" id="id19">[Lin82]</a>, among others. In this approach,</p>
<ul class="simple">
<li>the diffusing objects (or obstacles, or fittings, or scattering objects…) are considered as punctual. Sound particles are returned in all directions of space at each collision with a scattering object (except in the case of absorption). This assumption is generally valid when the wavelength is in the order of magnitude of the characteristic dimension of the obstacle;</li>
<li>the scattering phenomenon follows a Poisson process, which means that the probability of collision of a sound particle with a scattering object follows a Poisson’s law. The collision probabilities are independent of each other (the collision probability during time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(t+dt\)</span> is independent of collisions before time <span class="math notranslate nohighlight">\(t\)</span>);</li>
<li>the objects in the fitting zone do not produce particles (<em>i.e.</em> these objects are not sound sources).</li>
</ul>
<div class="figure align-center" id="id57">
<span id="illustration-diffusion-fittings"></span><a class="reference internal image-reference" href="_images/illustration_diffusion_fittings.png"><img alt="Schematic representation of the acoustic diffusion by obstacles in a fitting zone." src="_images/illustration_diffusion_fittings.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Schematic representation of the acoustic diffusion by obstacles in a fitting zone</span></p>
</div>
<p>A sound wave propagating in the environment may come into contact with scattering objects, causing the wave to diffract simultaneously and, in part, to absorb it. By analogy, in the particle approach, a particle that comes into contact with a scattering object can either be absorbed or reflected in another direction of propagation (see figure: <a class="reference internal" href="#illustration-diffusion-fittings"><span class="std std-ref">Schematic representation of the acoustic diffusion by obstacles in a fitting zone</span></a>). At the macroscopic scale, <em>i.e.</em> considering all the sound particles simultaneously, a diffusion process occurs, characterized by:</p>
<ul class="simple">
<li>the absorption coefficient <span class="math notranslate nohighlight">\(\alpha_c\)</span> of the scattering objects;</li>
<li>the bulk density <span class="math notranslate nohighlight">\(n_c\)</span> of the propagation medium, defined by the number <span class="math notranslate nohighlight">\(N_c\)</span> of obstacles present in the volume <span class="math notranslate nohighlight">\(V_c\)</span>:</li>
</ul>
<div class="math notranslate nohighlight">
\[n_c=\frac{N_c}{V_c}.\]</div>
<ul class="simple">
<li>the average scattering section <span class="math notranslate nohighlight">\(q_c\)</span>, <em>i.e.</em> the average surface of the scattering object, seen by a particle in a given incident direction. In practice, this data is very difficult to obtain, if not impossible, since the scattering objects are of complex and different shapes. In this condition, it is common to assimilate the diffusing object to a sphere, having the same external surface <span class="math notranslate nohighlight">\(s_c\)</span> as the object. Whatever the angle of incidence, the visible cross-section of the sphere (mean scattering cross-section) will be equal to a quarter of the total surface area of the sphere, or:</li>
</ul>
<div class="math notranslate nohighlight">
\[q_c=\frac{s_c}{4}.\]</div>
<ul class="simple">
<li>the average diffraction section per unit volume <span class="math notranslate nohighlight">\(\nu_c\)</span>, also called the diffusion frequency, by</li>
</ul>
<div class="math notranslate nohighlight">
\[\nu_c=n_c\,q_c,\]</div>
<p>– if all the scattering objects are identical, or</p>
<div class="math notranslate nohighlight">
\[\nu_c=\frac{1}{V}\sum_{p=1}^{N_c}\frac{s_{c_p}}{4}\]</div>
<p>– if each object diffusing <span class="math notranslate nohighlight">\(p\)</span> is defined by its surface <span class="math notranslate nohighlight">\(s_{c_p}\)</span>. In practice, and in the rest of the document, the diffusing objects will be considered uniform in the same volume of diffusion. Nevertheless, within the same propagation volume, several separate diffusion volumes can be considered.</p>
<p>Since the scattering phenomenon follows a Poisson’s law, the probability that a sound particle will collide with scattering objects after a time <span class="math notranslate nohighlight">\(t_k\)</span> is equal to:</p>
<div class="math notranslate nohighlight">
\[W_k (c\,t_k)=\frac{\left(\nu_c \, c\,t_k\right)^k}{k!}\exp\left(-\nu_c\, c\, t_k\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(c\, t_k\)</span> is the distance covered during a time <span class="math notranslate nohighlight">\(t_k\)</span>, which can be expressed from the distance <span class="math notranslate nohighlight">\(R_p\)</span> between two collisions (see figure: <a class="reference internal" href="#illustration-diffusion-fittings"><span class="std std-ref">Schematic representation of the acoustic diffusion by obstacles in a fitting zone</span></a>):</p>
<div class="math notranslate nohighlight">
\[c\,t_k=\sum_{p=1}^k R_p.\]</div>
<p>Since the collision probabilities are independent of each other <a class="reference internal" href="references.html#ondet1989" id="id20">[OB89]</a>, it is easy to show that the random variables <span class="math notranslate nohighlight">\(R_i\)</span> (noted <span class="math notranslate nohighlight">\(R\)</span> afterwards) follow the following probability density <span class="math notranslate nohighlight">\(f(R)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-dispois">
<span class="eqno">(7)<a class="headerlink" href="#equation-dispois" title="Permalink to this equation">¶</a></span>\[\label{dispois} f(R)=\nu_c \exp\left(-\nu_c \, R\right).\]</div>
<p>The average free path <span class="math notranslate nohighlight">\(\lambda_c\)</span> (average distance between two collisions) is simply obtained by expressing the first moment of the above probability density, namely:</p>
<div class="math notranslate nohighlight">
\[\lambda_c=\int_0^\infty R\, f(R)\, dR=\frac{1}{\nu_c}.\]</div>
</div>
<div class="section" id="id21">
<h4>Modelling<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>By definition, the cumulative distribution function, associated with this probability density, is defined by the following relationship:</p>
<div class="math notranslate nohighlight" id="equation-fdc">
<span class="eqno">(8)<a class="headerlink" href="#equation-fdc" title="Permalink to this equation">¶</a></span>\[\label{fdc} p(\hat{R})=\int_0^{\hat{R}} f(R)\, dR=1-\exp\left(-\nu_c\,\hat{R}\right).\]</div>
<p>This cumulative distribution function simply expresses the probability that the particle will collide with a scattering object during a long path <span class="math notranslate nohighlight">\(\hat{R}\)</span>. This function is therefore null for <span class="math notranslate nohighlight">\(\hat{R}=0\)</span> and equal to <span class="math notranslate nohighlight">\(1\)</span> for <span class="math notranslate nohighlight">\(\hat{R}=\infty\)</span>. The numerical simulation of the diffusion process is performed by the inverse cumulative distribution function method, obtained by reversing the relationship <a class="reference internal" href="#equation-fdc">(8)</a> , <em>i.e.</em>:</p>
<div class="math notranslate nohighlight" id="equation-fdc2">
<span class="eqno">(9)<a class="headerlink" href="#equation-fdc2" title="Permalink to this equation">¶</a></span>\[\label{fdci} \hat{R}=-\frac{1}{\nu_c}\ln \left[ 1-p(\hat{R})\right].\]</div>
<p>The cumulative distribution function being between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, it can be assimilated to a random variable <span class="math notranslate nohighlight">\(\xi\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>. By drawing a succession of random variables <span class="math notranslate nohighlight">\(\xi_i\)</span>, we can determine a succession of paths of length <span class="math notranslate nohighlight">\(\hat{R}_i\)</span> that satisfies the distribution function <a class="reference internal" href="#equation-dispois">(7)</a> of our problem:</p>
<div class="math notranslate nohighlight">
\[\label{fdci_2} \hat{R}_n=-\frac{1}{\nu_c}\ln \left[ 1-\xi_n\right].\]</div>
<p>An example of a random draw using the inverse cumulative distribution method is shown in Figure [fig:verification_diffusion_encrowding]. The comparison with the theoretical distribution shows an excellent behaviour of the method.</p>
<div class="figure align-center" id="id58">
<span id="verification-diffusion-fittings"></span><a class="reference internal image-reference" href="_images/verification_diffusion_fittings.png"><img alt="Distribution of the distance between two collission obtained by the inverse cumulative distribution function method and comparison with the theoretical distribution." src="_images/verification_diffusion_fittings.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Distribution of the <span class="math notranslate nohighlight">\(\hat{R}_i\)</span> paths obtained by the inverse cumulative distribution function method and comparison with the theoretical distribution</span></p>
</div>
<p>When a sound particle <span class="math notranslate nohighlight">\(n\)</span> enters a fitting zone, it is associated with a collision distance <span class="math notranslate nohighlight">\(R_n\)</span> with an object of the congestion by applying the relationship <a class="reference internal" href="#equation-fdc2">(9)</a>. As the sound particle propagates in the crowded area, a test is performed to determine if the cumulative distance <span class="math notranslate nohighlight">\(d_n\)</span> of the particle in the crowded area is less or more than <span class="math notranslate nohighlight">\(R_n\)</span>. If the distance traveled <span class="math notranslate nohighlight">\(d_n\)</span> is greater than the collision distance <span class="math notranslate nohighlight">\(R_n\)</span> the particle collides with an object. In the ‘Energetic’ mode, the energy of the sound particle is weighted by the average absorption coefficient <span class="math notranslate nohighlight">\(\alpha_c\)</span> of the space requirement and continues its propagation in a random direction (uniform distribution). In the ‘Random’ mode, a new random draw on a uniform variable <span class="math notranslate nohighlight">\(u\)</span> allows to determine if the particle is absorbed by the diffusing object (same procedure than for considering absorption by a wall), or reflected in a uniform direction. After each collision, the cumulative propagation distance is reset to zero, and a new draw is made to determine the next collision distance. Whatever the calculation mode chosen, as long as the distance travelled by the particle is less than the collision distance, the particle continues its path without changing direction.</p>
</div>
</div>
</div>
<div class="section" id="wall-modelling">
<h2>Wall modelling<a class="headerlink" href="#wall-modelling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id22">
<h3>Physical description<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<div class="section" id="absorption-dissipation-and-acoustic-transmission">
<h4>Absorption, dissipation and acoustic transmission<a class="headerlink" href="#absorption-dissipation-and-acoustic-transmission" title="Permalink to this headline">¶</a></h4>
<p>In contact with a wall (see figure <a class="reference internal" href="#geo-wall"><span class="std std-ref">Illustration of the mechanisms of reflection, absorption, dissipation (internal loss) and acoustic transmission through a wall</span></a>), a sound wave will be partly reflected back into the domain for one part <span class="math notranslate nohighlight">\(R\)</span>, partly dissipated by transforming the acoustic energy into heat in the material for the other part <span class="math notranslate nohighlight">\(\beta\)</span>), the rest being transmitted through the material in the adjacent domain for the other par <span class="math notranslate nohighlight">\(\tau\)</span>. The latter coefficient is defined as the transmission factor. If <span class="math notranslate nohighlight">\(W_i\)</span> is the power incident on a wall, then a part <span class="math notranslate nohighlight">\(W_r=R\,W_i\)</span> will be reflected, a part <span class="math notranslate nohighlight">\(W_d=\beta\,W_i\)</span> will be dissipated in the material, and a part <span class="math notranslate nohighlight">\(W_t=\tau\,W_i\)</span> will be transmitted through the partition. By construction (there can be no creation of energy, nor more absorption than incident energy), the coefficients <span class="math notranslate nohighlight">\(R\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> are between 0 and 1, so the energy balance of the wall is written:</p>
<div class="math notranslate nohighlight">
\[R+\beta+\tau=1.\]</div>
<div class="figure align-center" id="id59">
<span id="geo-wall"></span><a class="reference internal image-reference" href="_images/geo_wall.png"><img alt="Illustration of the mechanisms of reflection, absorption, dissipation and acoustic transmission through a wall." src="_images/geo_wall.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Illustration of the mechanisms of reflection, absorption, dissipation (internal loss) and acoustic transmission through a wall</span></p>
</div>
<p>It is usual to define the absorption coefficient <span class="math notranslate nohighlight">\(\alpha\)</span> of the wall as the sum of the transmitted part <span class="math notranslate nohighlight">\(\tau\)</span> and the dissipated part (internal loss) <span class="math notranslate nohighlight">\(\beta\)</span>, in the form <span class="math notranslate nohighlight">\(\alpha=\beta+\tau\)</span>, so that the above energy balance is written:</p>
<div class="math notranslate nohighlight">
\[R=1-\alpha.\]</div>
<p>The absorption coefficient of a material can be measured using the standardised procedures <a class="reference internal" href="I_Simpa_standard.html#term-iso-354"><span class="xref std std-term">ISO 354</span></a> for the reverberation chamber method, as well as <a class="reference internal" href="I_Simpa_standard.html#term-iso-10534-1"><span class="xref std std-term">ISO 10534-1</span></a> and <a class="reference internal" href="I_Simpa_standard.html#term-iso-10534-2"><span class="xref std std-term">ISO 10534-2</span></a> for the impedance tube method. For the sound transmission coefficient, the reader may refer to the different parts of the standards for air transmission (ISO 140).</p>
</div>
<div class="section" id="acoustic-diffusion">
<h4>Acoustic diffusion<a class="headerlink" href="#acoustic-diffusion" title="Permalink to this headline">¶</a></h4>
<p>On the other hand, depending on the shape, size and distribution of the wall irregularities, the sound wave can be reflected simultaneously in the specular direction and in other directions. In room acoustics, it is common to consider that a fraction <span class="math notranslate nohighlight">\(1-s\)</span> of the sound energy will be reflected in the direction of specular reflection, while a fraction <span class="math notranslate nohighlight">\(s\)</span> of the energy will be reflected in the other directions of space, according to a law of reflection characterized by irregularities in the wall <a class="reference internal" href="references.html#embrechts2001" id="id23">[EAS01]</a>. In the latter case, we speak of <em>diffuse reflection</em>, where <span class="math notranslate nohighlight">\(s\)</span> is called scattering coefficient.</p>
<p>In room acoustics, numerous theoretical and experimental studies are currently underway to characterize or measure these laws of reflection <a class="reference internal" href="references.html#vorlander2000" id="id24">[VM00]</a><a class="reference internal" href="references.html#cox2016" id="id25">[CDAntonio16]</a>. However, the common practice is to use Lambert’s law to describe a diffuse reflection. The value of the scattering coefficient <span class="math notranslate nohighlight">\(s\)</span> can be obtained by a standardized measurement procedure (<a class="reference internal" href="I_Simpa_standard.html#term-iso-17497-1"><span class="xref std std-term">ISO 17497-1</span></a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is important to note that this scattering coefficient (<a class="reference internal" href="I_Simpa_standard.html#term-iso-17497-1"><span class="xref std std-term">ISO 17497-1</span></a>), which defines the ratio between non-specular reflected energy on the total energy, is different from the diffusion coefficient <span class="math notranslate nohighlight">\(\delta\)</span> (<a class="reference internal" href="I_Simpa_standard.html#term-iso-17497-2"><span class="xref std std-term">ISO 17497-2</span></a>), which defines the ability of the surface to uniformly scatter in all direction. In some acoustic simulation software, the diffraction coefficient <span class="math notranslate nohighlight">\(s\)</span> may sometimes wrongly called the diffusion coefficient.</p>
</div>
</div>
</div>
<div class="section" id="acoustic-reflection-modelling">
<h3>Acoustic reflection modelling<a class="headerlink" href="#acoustic-reflection-modelling" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id26">
<h4>Random modelling<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>First, a sound particle colliding with a wall can either be absorbed by the wall (with a probability <span class="math notranslate nohighlight">\(\alpha\)</span>), or reflected in a new direction of propagation (with a probability <span class="math notranslate nohighlight">\(R=1-\alpha\)</span>). In practice, the absorption/reflection choice is made by randomly drawing a number <span class="math notranslate nohighlight">\(u\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, following a uniform distribution:</p>
<ul>
<li><p class="first">If this number is less than <span class="math notranslate nohighlight">\(\alpha=1-R\)</span> (at the considered point), the particle is absorbed and disappears from the propagation medium.</p>
</li>
<li><p class="first">If this number is greater than <span class="math notranslate nohighlight">\(\alpha=1-R\)</span>, the particle is reflected and continues to propagate in a new direction. In this last case, to determine the type of reflection (specular or diffuse), a new random draw <span class="math notranslate nohighlight">\(v\)</span> is performed between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>:</p>
<blockquote>
<div><p>– If this number is less than the value of <span class="math notranslate nohighlight">\(1-s\)</span> (<em>i.e.</em> <span class="math notranslate nohighlight">\(v&lt;(1-s)\)</span>) at the point considered, the particle is specularly reflected, in accordance with the well-known Snell-Descartes laws.</p>
<p class="attribution">&mdash;Otherwise (<em>i.e.</em> if <span class="math notranslate nohighlight">\(v&gt;(1-s)\)</span>), the reflection is diffuse. In the latter case, it is necessary to determine the direction of diffuse reflection.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="id27">
<h4>Energetic modelling<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>When a particle collides with a wall, its energy <span class="math notranslate nohighlight">\(\epsilon\)</span> is weighted by the reflection coefficient <span class="math notranslate nohighlight">\(R=1-\alpha\)</span>. The choice of specular or diffuse reflection, depending on the scattering coefficient, is identical to the ‘Random’ method: a random draw <span class="math notranslate nohighlight">\(v\)</span> is performed between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>. If this number is less than the value of <span class="math notranslate nohighlight">\(1-s\)</span>, the particle is specularly reflected. Otherwise, the reflection is diffuse, in a direction to be determined. An entirely ‘Energetic’ treatment would be possible by duplicating the particle into two particles, the first being reflected in the specular direction and the second in the diffuse direction; however this last solution is not yet implemented in the <strong>SPPS</strong> code..</p>
</div>
</div>
<div class="section" id="modelling-of-the-reflection-laws">
<h3>Modelling of the reflection laws<a class="headerlink" href="#modelling-of-the-reflection-laws" title="Permalink to this headline">¶</a></h3>
<div class="section" id="formalism">
<h4>Formalism<a class="headerlink" href="#formalism" title="Permalink to this headline">¶</a></h4>
<p>Let us consider an incident sound particle on a wall, whose incident direction is defined by the spherical coordinates <span class="math notranslate nohighlight">\((\theta,\phi)\)</span> (see figure <a class="reference internal" href="#geo-reflection"><span class="std std-ref">Elementary geometry of a reflection by a wall</span></a>). This particle has a probability of <span class="math notranslate nohighlight">\(P(\theta,\phi;\theta',\phi')\equiv P(\Omega,\Omega')\)</span> being reflected in the elementary solid angle <span class="math notranslate nohighlight">\(d\Omega' =\sin\phi'\, d\phi'\, d\phi'\, d\theta'\)</span> <a class="reference internal" href="references.html#joyce1974" id="id28">[Joy74]</a><a class="reference internal" href="references.html#joyce1975" id="id29">[Joy75]</a><a class="reference internal" href="references.html#joyce1978" id="id30">[Joy78]</a><a class="reference internal" href="references.html#lepolles2003" id="id31">[LP03]</a>.</p>
<div class="figure align-center" id="id60">
<span id="geo-reflection"></span><a class="reference internal image-reference" href="_images/geo_reflection.png"><img alt="Elementary geometry of a reflection by a wall" src="_images/geo_reflection.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Elementary geometry of a reflection by a wall</span></p>
<div class="legend">
Variables <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\phi'\)</span> refer respectively to the angles of incidence and reflection with respect to the normal at the wall. The angles <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\theta'\)</span> in the tangent plane, directions of incidence and reflection, are not represented (<span class="math notranslate nohighlight">\(\phi,\phi'\in[0,\pi/2]\)</span> and <span class="math notranslate nohighlight">\(\theta,\theta'\in[0,2\pi]\)</span>).</div>
</div>
<p><span class="math notranslate nohighlight">\(P(\Omega,\Omega')\,d\Omega'\)</span> actually represents the fraction of the incident sound intensity that is reflected in the solid angle <span class="math notranslate nohighlight">\(d\Omega'\)</span>. Let’s say <span class="math notranslate nohighlight">\(j(\theta,\phi)\)</span> the incident flow of particles. The flow of reflected particles <span class="math notranslate nohighlight">\(j'(\theta',\phi')\)</span> is expressed:</p>
<div class="math notranslate nohighlight" id="equation-eq-flux-1">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-flux-1" title="Permalink to this equation">¶</a></span>\[\label{eq_flux_1} j'(\theta',\phi') \cos \phi'=\int
            P(\theta,\phi;\theta',\phi')\, j(\theta,\phi) \cos \phi \,d\Omega.\]</div>
<p>Defining the reflection law <span class="math notranslate nohighlight">\(R(\theta,\phi;\theta',\phi')\equiv R(\Omega,\Omega')\)</span> on the following:</p>
<div class="math notranslate nohighlight">
\[R(\theta,\phi;\theta',\phi')=\frac{P(\theta,\phi;\theta',\phi')}{\cos(\phi')},\]</div>
<p>the relation <a class="reference internal" href="#equation-eq-flux-1">(10)</a> can be written:</p>
<div class="math notranslate nohighlight">
\[\label{eq_flux_1b} j'(\theta',\phi') =\int
            R(\theta,\phi;\theta',\phi')\, j(\theta,\phi) \cos \phi \,d\Omega.\]</div>
<p>It is important to emphasize the difference between the law of reflection <span class="math notranslate nohighlight">\(R\)</span> and the probability <span class="math notranslate nohighlight">\(P\)</span>. <span class="math notranslate nohighlight">\(P\)</span> refers to a probability of reflection of a sound particle by elementary solid angle, while <span class="math notranslate nohighlight">\(R\)</span> refers to the flow of energy reflected in a direction <span class="math notranslate nohighlight">\(\phi'\)</span>, for an incident flow in the direction <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<p>The first law of thermodynamics requires the conservation of the flow on the surface (in the absence of absorption). The law of reflection <span class="math notranslate nohighlight">\(R(\Omega,\Omega')\)</span> must therefore check the following condition:</p>
<div class="math notranslate nohighlight">
\[\label{loi_2} \int P(\Omega,\Omega') \,d\Omega'=\int
            R(\Omega,\Omega')\cos\phi' \,d\Omega'=1,\]</div>
<p>or, in spherical coordinates,</p>
<div class="math notranslate nohighlight">
\[\label{loi_2b} \iint R(\theta,\phi;\theta',\phi')\cos\phi'
            \,\sin\phi'\,d\phi'\,d\theta'=1.\]</div>
<p>The second law of thermodynamics imposes this time:</p>
<div class="math notranslate nohighlight" id="equation-loi-1">
<span class="eqno">(11)<a class="headerlink" href="#equation-loi-1" title="Permalink to this equation">¶</a></span>\[\label{loi_1} \int P(\Omega,\Omega') \,d\Omega=\int
            R(\Omega,\Omega')\cos\phi \,d\Omega=1,\]</div>
<p>or, in spherical coordinates,</p>
<div class="math notranslate nohighlight" id="equation-loi-1b">
<span class="eqno">(12)<a class="headerlink" href="#equation-loi-1b" title="Permalink to this equation">¶</a></span>\[\label{loi_1b} \iint R(\theta,\phi;\theta',\phi')\cos\phi
            \,\sin\phi\,d\phi\,d\theta=1.\]</div>
<p>On the other hand, the principle of reciprocity requires that</p>
<div class="math notranslate nohighlight" id="equation-loi-3">
<span class="eqno">(13)<a class="headerlink" href="#equation-loi-3" title="Permalink to this equation">¶</a></span>\[\label{loi_3} R(\Omega,\Omega')=R(\Omega',\Omega).\]</div>
<p>Despite some recent studies, and apart from Lambert’s law widely used to model diffuse reflections <a class="reference internal" href="references.html#kuttruff2016" id="id32">[Kut16]</a>, to our knowledge there are no other laws of reflection for real walls. In the <strong>SPPS</strong> code, however, we propose arbitrary modes of reflection, more or less real, presented in figure <a class="reference internal" href="#geo-reflection-law"><span class="std std-ref">Illustration of the reflection laws proposed in the SPPS code</span></a>.</p>
<div class="figure align-center" id="id61">
<span id="geo-reflection-law"></span><a class="reference internal image-reference" href="_images/geo_reflection_law.png"><img alt="Illustration of the reflection laws proposed in the SPPS code." src="_images/geo_reflection_law.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-text">Illustration of the reflection laws proposed in the <strong>SPPS</strong> code</span></p>
</div>
</div>
<div class="section" id="specular-reflection">
<h4>Specular reflection<a class="headerlink" href="#specular-reflection" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id33">
<h5>Physical description<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h5>
<p>The simplest mode of reflection is defined by specular reflection and can be written in three dimensions:</p>
<div class="math notranslate nohighlight">
\[R(\theta,\phi;\theta',\phi')=2 \delta(\theta-\theta' \pm \pi)
            \,\delta(\sin^2 \phi-\sin^2 \phi'),\]</div>
<p>where the couples <span class="math notranslate nohighlight">\((\theta,\phi)\)</span> and <span class="math notranslate nohighlight">\((\theta',\phi')\)</span> refer respectively to the incident and reflected directions of the sound particles on the wall. Although the form of this expression is not conventional, this relationship verifies the laws of Snell-Descartes, as well as the conditions <a class="reference internal" href="#equation-loi-1">(11)</a> to <a class="reference internal" href="#equation-loi-3">(13)</a>.</p>
</div>
<div class="section" id="id34">
<h5>Modelling<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h5>
<p>From a numerical point of view, the simulation of this reflection law does not pose a major problem, since the angles of incidence of each particle on a wall are known. The modelling is identical for the ‘Random’ and ‘Energetic’”’ approaches.</p>
</div>
</div>
<div class="section" id="uniform-reflection">
<h4>Uniform reflection<a class="headerlink" href="#uniform-reflection" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id35">
<h5>Physical description<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h5>
<p>A uniform reflection law produces a distribution of reflection angles <span class="math notranslate nohighlight">\(P(\Omega')\)</span> that is equiprobable. This should not be confused with Lambert’s law of reflection, for which uniformity is verified by the law of reflection. In the case of a uniform law, particles are reflected uniformly throughout the half space, regardless of the angle of incidence. Under these conditions, the reflection density after normalization is written:</p>
<div class="math notranslate nohighlight">
\[P(\Omega')d\Omega'= P(\theta',\phi')d\Omega'=\left[\frac{1}{2\pi}\,d\theta'\right] \,\left[\sin \phi' \,d\phi'\right],\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[R(\theta',\phi')=\frac{1}{2\pi\cos\phi'},\]</div>
<p>with <span class="math notranslate nohighlight">\(\theta'\in[0,2\pi]\)</span> and <span class="math notranslate nohighlight">\(\phi'\in[0,\pi/2]\)</span>.</p>
</div>
<div class="section" id="id36">
<h5>Modelling<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h5>
<p>From a numerical point of view, the determination of the angle of reflection is again obtained by the inverse cumulative distribution function method,</p>
<div class="math notranslate nohighlight">
\[f(\hat{\phi})= \int_{0}^{\hat{\phi}} \sin\phi'\,d\phi'=1-\cos\hat{\phi},\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[\hat{\phi}=\cos^{-1}\left(1-u\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is a random number between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
</div>
<div class="section" id="lambert-reflection">
<h4>Lambert reflection<a class="headerlink" href="#lambert-reflection" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id37">
<h5>Physical description<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h5>
<p>In optics, a perfectly diffuse surface is a surface that also appears bright regardless of the angle of observation, and regardless of the angle of incidence. In terms of acoustics, a perfectly diffuse surface will reflect the same energy in all directions regardless of the angle of incidence. From a mathematical point of view, this condition requires that the law of reflection <span class="math notranslate nohighlight">\(R\)</span> be independent of the direction of reflection, and therefore of the direction of incidence (by reciprocity). After normalization, the law of reflection is written:</p>
<div class="math notranslate nohighlight">
\[R(\theta,\phi;\theta',\phi')=\frac{1}{2\pi}\times 2.\]</div>
<p>The coefficient <span class="math notranslate nohighlight">\(1/2\pi\)</span> is related to the normalization according to the angle <span class="math notranslate nohighlight">\(\theta'\)</span> (uniform distribution between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2\pi\)</span>). The second coefficient (factor <span class="math notranslate nohighlight">\(2\)</span>) is related to the normalization according to the angle <span class="math notranslate nohighlight">\(\phi'\)</span>. The probability of <span class="math notranslate nohighlight">\(P(\Omega') d\Omega'\)</span> is therefore reduced to</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
            P(\Omega') \, d\Omega' &amp; =  R\,\cos\phi'\,\sin\phi'\,d\theta'\,d\phi'\\
            &amp; = \left[\frac{1}{2\pi}\,d\theta'\right]\, \left[2 \cos\phi'\,\sin\phi'\,d\phi'\right],
            \end{aligned}\end{split}\]</div>
</div></blockquote>
<p>where the expression <span class="math notranslate nohighlight">\(\cos\phi'\)</span> is related to Lambert’s law. It is easy to check that <span class="math notranslate nohighlight">\(R\)</span> checks the conditions <a class="reference internal" href="#equation-loi-1">(11)</a> to <a class="reference internal" href="#equation-loi-3">(13)</a>. It is important to note the difference between a random surface and an uniform surface. The first one is conditioned by an uniform random reflection law <span class="math notranslate nohighlight">\(R\)</span>, while the second is defined by a uniform probability <span class="math notranslate nohighlight">\(P\)</span>.</p>
</div>
<div class="section" id="id38">
<h5>Modelling<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h5>
<p>From a numerical point of view, the random drawing of the reflection angles (in three dimensions) must be carried out in accordance with the distribution <span class="math notranslate nohighlight">\(P(\Omega')\)</span>, <em>i.e.</em> <span class="math notranslate nohighlight">\(P(\phi')\)</span> in our case. Applying the inverse cumulative distribution function method, the probability <span class="math notranslate nohighlight">\(f(\hat{\phi})\)</span> that a sound particle is reflected in an angle <span class="math notranslate nohighlight">\(\phi'\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(\hat{\phi}\)</span> is given by the following relationship:</p>
<div class="math notranslate nohighlight">
\[f(\hat{\phi})=2\int_{0}^{\hat{\phi}} \cos\phi'\sin\phi'\,d\phi'=\sin^2 \hat{\phi}.\]</div>
<p>Since this probability is between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, the choice of angle <span class="math notranslate nohighlight">\(\hat{\phi}\)</span> is made by randomly drawing a number <span class="math notranslate nohighlight">\(u\in[0.1]\)</span>, such that:</p>
<div class="math notranslate nohighlight">
\[\hat{\phi}=\sin^{-1}\sqrt{u}=\cos^{-1}\left(1-u\right)^\frac{1}{2}.\]</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It is important to note that other authors <a class="reference internal" href="references.html#burns1990" id="id39">[BMC90]</a><a class="reference internal" href="references.html#hodgson1991" id="id40">[Hod91]</a><a class="reference internal" href="references.html#lam1996" id="id41">[Lam96]</a><a class="reference internal" href="references.html#xiangyang2002" id="id42">[XKaJ02]</a> mention other relationships. The correct formulation depends on the angle convention. It is also possible that some of the relationships that are proposed may not be accurate.</p>
</div>
</div>
</div>
<div class="section" id="normal-reflection-w-n">
<h4>Normal reflection <span class="math notranslate nohighlight">\(w^n\)</span><a class="headerlink" href="#normal-reflection-w-n" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id43">
<h5>Physical description<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h5>
<p>Let us consider a law of reflection independent of the incident direction and defined only by the angle of reflection <span class="math notranslate nohighlight">\(\phi'\)</span> around the normal to the wall (<span class="math notranslate nohighlight">\(\theta'\)</span> being uniform between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2\pi\)</span>), of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
            R(\Omega')&amp;=R(\theta',\phi')\\
            &amp;=\frac{1}{2\pi}\times (n+1)\cos^{n-1}\phi'\\
            &amp;=\frac{n+1}{2\pi}\,w^{n-1}.
            \end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is a positive integer. The quantity noted <span class="math notranslate nohighlight">\(w=\cos\phi'\)</span> is none other than the projection of the direction of reflection on the normal at the wall. According to the notations in this document, the probability <span class="math notranslate nohighlight">\(P\)</span> will therefore be expressed:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
            P(\Omega')\,d\Omega'&amp;=P(\phi')\,\sin\phi'\,d\theta'\,d\phi'\\
            &amp;=\left[\frac{1}{2\pi}d\theta'\right] \times \left[(n+1)\cos^{n}\phi'\,d\phi'\right]\\
            &amp;=\frac{n+1}{2\pi}\,w^{n}\,d\theta'\,d\phi'
            \end{aligned}\end{split}\]</div>
<p>which justifies the name “law in <span class="math notranslate nohighlight">\(w^n\)</span>”. This form of reflection is identical to the one introduced in (lepolles2003). It can be noted that this type of law is a generalized form of Lambert’s law (<span class="math notranslate nohighlight">\(n=1\)</span>) and the uniform law (<span class="math notranslate nohighlight">\(n=0\)</span>).</p>
</div>
<div class="section" id="id44">
<h5>Modelling<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h5>
<p>From a numerical point of view, the random drawing of the angles of reflection is achieved by applying the inverse cumulative distribution function method. The probability <span class="math notranslate nohighlight">\(f(\hat{\Omega})\)</span> (<em>i.e.</em> the probability <span class="math notranslate nohighlight">\(f(\hat{\phi})\)</span> since the direction of reflection depends only on the angle with respect to normal) that a sound particle is reflected in an elementary solid angle between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(\hat{\Omega}\)</span> is then given by the relationship:</p>
<div class="math notranslate nohighlight">
\[f(\hat{\phi})= (n+1)\int_{0}^{\hat{\phi}} \cos^n\phi'\sin\phi'\, d\phi'\phi' =1-\cos^{n+1}\hat{\phi}.\]</div>
<p>Since this probability is between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, the choice of angle <span class="math notranslate nohighlight">\(\hat{\phi}\)</span> is made by randomly drawing a number <span class="math notranslate nohighlight">\(u\in[0.1]\)</span>, such that:</p>
<div class="math notranslate nohighlight">
\[\hat{\phi}=\cos^{-1}\left(1-u\right)^\frac{1}{n+1}.\]</div>
</div>
</div>
</div>
<div class="section" id="acoustic-transmission-modelling">
<h3>Acoustic transmission modelling<a class="headerlink" href="#acoustic-transmission-modelling" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id45">
<h4>Physical description<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h4>
<p>As mentioned above, the part of the power that is not reflected by the wall is either dissipated in the wall or transmitted. The acoustic transmission is then defined by the transmission factor <span class="math notranslate nohighlight">\(\tau\)</span>, defined as the ratio of the transmitted power <span class="math notranslate nohighlight">\(W_t\)</span> by the wall to the incident power <span class="math notranslate nohighlight">\(W_i\)</span>. If there is no dissipation in the wall (<em>i.e.</em> everything is transmitted through the wall), then <span class="math notranslate nohighlight">\(\tau=\alpha\)</span>. Otherwise, <span class="math notranslate nohighlight">\(\tau&lt;\alpha\)</span>. In practice, acoustic transmission is rather defined by the insertion loss (IL or <span class="math notranslate nohighlight">\(R\)</span>) of the wall, which is a function of the transmission factor through the following relationship:</p>
<div class="math notranslate nohighlight">
\[R=10\,\log\left(\frac{W_i}{W_t}\right)=-10\,\log{\tau}.\]</div>
</div>
<div class="section" id="id46">
<h4>Random modelling<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h4>
<p>The modelling is similar to the one used for acoustic reflection. To determine if the sound particle is dissipated or transmitted by the partition, it is necessary to draw a number <span class="math notranslate nohighlight">\(w\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<ul class="simple">
<li>If this number is less than <span class="math notranslate nohighlight">\(\tau\)</span>, the particle is transmitted and keeps its direction of propagation;</li>
<li>Otherwise the particle is ‘dissipated’ and disappears from the propagation medium.</li>
</ul>
</div>
<div class="section" id="id47">
<h4>Energetic modelling<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h4>
<p>The energy modeling is performed by weighting the energy of the particle once transmitted by the partition, by the coefficient <span class="math notranslate nohighlight">\(\tau\)</span>. In this case, there is no change of direction of propagation.</p>
</div>
</div>
<div class="section" id="verification-of-wall-modelling">
<h3>Verification of wall modelling<a class="headerlink" href="#verification-of-wall-modelling" title="Permalink to this headline">¶</a></h3>
<p>The figure <a class="reference internal" href="#fig-test-reflexion"><span class="std std-ref">Verification of the procedure for modelling absorption (dissipation and transmission) and reflection (specular and diffuse) phenomena</span></a> illustrates the result of the reflection procedure (reflection=specular/diffuse, absorption=loss/transmission) in random mode, with the following acoustic parameters: scattering coefficient <span class="math notranslate nohighlight">\(s=0.6\)</span>, absorption coefficient <span class="math notranslate nohighlight">\(\alpha=0.8\)</span>, transmission coefficient <span class="math notranslate nohighlight">\(\tau=10^{-R/10}=0.1\)</span> (attenuation index <span class="math notranslate nohighlight">\(R=10\)</span> dB). With <span class="math notranslate nohighlight">\(10000\)</span> realizations, the different phenomena are found (in terms of number of realizations) with the same proportions as the imposed acoustic parameters.</p>
<div class="figure align-center" id="id62">
<span id="fig-test-reflexion"></span><a class="reference internal image-reference" href="_images/figure_test_reflexion.png"><img alt="Verification of the procedure for modelling absorption, transmission and reflection." src="_images/figure_test_reflexion.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Verification of the procedure for modelling absorption (dissipation and transmission) and reflection (specular and diffuse) phenomena</span></p>
</div>
<p>In the previous figure, only the random drawing process is modelled (note that this simulation was realized with a very simplementation of the method, not the the one implemented in the <strong>SPPS</strong> code, this last one being more performant).</p>
<ul class="simple">
<li>The first group ‘Total’ corresponds to the sum of the number of achievements (initial number of particles, reflection + absorption, specular + diffus + dissipation + transmission); these three quantities therefore have the exactly same value, which the initial number of sound particles (<em>i.e.</em> 10000).</li>
<li>The second group corresponds to the ‘Reflection’ process, divided into the total number of reflections (R, 2005 particles, <em>i.e</em> an equivalent reflection coefficient of 0.2005, which is quite the same that the initial condition of the random process <span class="math notranslate nohighlight">\(R=1-\alpha=0.2\)</span>), specular reflections (S, 788 particles) and diffusion (Df, 1217 particles, , <em>i.e</em> an equivalent scattering coefficient of 1217/2005=0.61, which is quite the same that the initial condition of the random process <span class="math notranslate nohighlight">\(s=0.6\)</span>)).</li>
<li>The third group corresponds to the ‘Absorption’ process, divided into the total number of absorption (A, 7995 particles, , <em>i.e</em> an equivalent absorption coefficient of 0.7995, which is quite the same that the initial condition of the random process <span class="math notranslate nohighlight">\(\alpha=0.8\)</span>)), dissipation (D, 7014 particles) and transmission (T, 981 particles, , <em>i.e</em> an equivalent transmission coefficient of 0.0981, which is quite the same that the initial condition of the random process <span class="math notranslate nohighlight">\(\tau=0.1\)</span>)).</li>
</ul>
</div>
</div>
<div class="section" id="calculation-of-sound-levels-at-observation-points">
<h2>Calculation of sound levels at observation points<a class="headerlink" href="#calculation-of-sound-levels-at-observation-points" title="Permalink to this headline">¶</a></h2>
<p>In the <strong>SPPS</strong> code, two types of receivers are considered:</p>
<ul class="simple">
<li>‘Volume’ receivers model the so-called “classical” point receivers. Since the notion of point receiver is not applicable in the <strong>SPPS</strong> code, since in theory the probability that a sound particle will pass through a point receiver is zero, it is necessary to give a volume to the receiver point, to count the number of particles that have passed through it, and thus deduce the energy density at the observation point. For a point receiver, the <strong>SPPS</strong> code returns the sound pressure level, at each time step of the calculation and for each frequency band considered;</li>
<li>‘Surface’ receivers are surface elements (like a face element of the 3D scene) on which incident sound intensities are calculated, which then makes it possible to construct acoustic maps. For a surface receiver, the code <strong>SPPS</strong> returns the sound intensity, at each time step of the calculation and for each frequency band considered.</li>
</ul>
<p>In addition, the calculation code also determines the overall sound pressure level in the 3D model, summing the contributions of each particle, at each time step and for each frequency band.</p>
<div class="section" id="calculation-of-the-sound-pressure-level-at-a-volume-receiver">
<h3>Calculation of the sound pressure level at a volume receiver<a class="headerlink" href="#calculation-of-the-sound-pressure-level-at-a-volume-receiver" title="Permalink to this headline">¶</a></h3>
<p>The amount of <strong>energy</strong> <span class="math notranslate nohighlight">\(E_\text{rec}^{j}(n)\)</span> (in J or W.s) in the frequency band <span class="math notranslate nohighlight">\(j\)</span> received at a volume receiver, at the time step <span class="math notranslate nohighlight">\(n\)</span> (<em>i.e.</em> to time <span class="math notranslate nohighlight">\(n \Delta t\)</span>) is equal to the sum of the energies <span class="math notranslate nohighlight">\(\varepsilon_i^{j}\)</span> brought by each particle <span class="math notranslate nohighlight">\(i\)</span> in the frequency band <span class="math notranslate nohighlight">\(j\)</span>, crossing the receiver volume during the time step <span class="math notranslate nohighlight">\(n\)</span> (figure[principle_receiver_volumique]):</p>
<div class="math notranslate nohighlight">
\[E_\text{rec}^{j}(n)=\sum_i^{N_0} \varepsilon_i^{j} = \sum_i^{N_0} \frac{W}{N} \epsilon_i^{j} \times \Delta t_i,\]</div>
<p>where <span class="math notranslate nohighlight">\({N_0}\)</span> is the total number of particles passing through the receiver volume and <span class="math notranslate nohighlight">\(\Delta t_i\)</span> is the presence time of the particle <span class="math notranslate nohighlight">\(i\)</span> in the receiver volume (<span class="math notranslate nohighlight">\(\Delta t_i&lt;\Delta t\)</span>), and <span class="math notranslate nohighlight">\(\epsilon_i^{j}\)</span> the weighting coefficient (between 0 and 1) associated with the particle <span class="math notranslate nohighlight">\(i\)</span> in the frequency band <span class="math notranslate nohighlight">\(j\)</span>. If the calculation mode is “random”, the coefficient <span class="math notranslate nohighlight">\(\epsilon_i^{j}\)</span> is constant and equal to the unit (1). If the calculation mode is “energetic”, the coefficient <span class="math notranslate nohighlight">\(\epsilon_i^{j}\)</span> translates the cumulative loss of energy in the frequency band <span class="math notranslate nohighlight">\(j\)</span> of the particle <span class="math notranslate nohighlight">\(i\)</span> throughout its path due to the physical phenomena encountered (absorption by walls and obstructions, atmospheric absorption, sound transmission…). The presence time <span class="math notranslate nohighlight">\(\Delta t_i\)</span> can also be expressed as a function of the length of the path of the particle <span class="math notranslate nohighlight">\(i\)</span> in the receiving volume, <em>i.e.</em> <span class="math notranslate nohighlight">\(\ell_i\)</span>, such as <span class="math notranslate nohighlight">\(\Delta t_i=\ell_i/c\)</span>, <span class="math notranslate nohighlight">\(c\)</span> being the velocity of the particle at the observation point. Considering a “volume” receiver is defined by a spherical volume of radius <span class="math notranslate nohighlight">\(r_\text{rec}\)</span> (and volume <span class="math notranslate nohighlight">\(V_\text{rec}\)</span>), the <strong>energy density</strong> <span class="math notranslate nohighlight">\(w_\text{rec}^{j}(n)\)</span> (J/m<span class="math notranslate nohighlight">\(^3\)</span>) in the volume receiver, for the frequency band <span class="math notranslate nohighlight">\(j\)</span>, is given by:</p>
<div class="math notranslate nohighlight" id="equation-eq-density-energy-punctual-receiver">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-density-energy-punctual-receiver" title="Permalink to this equation">¶</a></span>\[\label{densite_energie_recepteur_volumique}
        w_\text{rec}^{j}(n)=\frac{E_\text{rec}(n)}{V_\text{rec}}= \frac{W}{N} \frac{1}{V_\text{rec}} \sum_i^{N_0} \epsilon_i^{j} \frac{\ell_i}{c}.\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The definition of the receiver volume is a crucial element for the quality and representativeness of the results. It must be large enough to count sound particles as they propagate, but not too large to make the energy density calculated at the observation point representative.</p>
</div>
<div class="figure align-center" id="id63">
<span id="geo-punctual-receiver"></span><a class="reference internal image-reference" href="_images/geo_punctual_receiver.png"><img alt="Principle of the calculation of the sound pressure level for a volume receiver." src="_images/geo_punctual_receiver.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Principle of the calculation of the sound pressure level for a volume receiver</span></p>
<div class="legend">
The energy density in the volume receiver is calculated by summing the energy contributions of each particle passing through the receiver. The contribution of the particle <span class="math notranslate nohighlight">\(i\)</span> is calculated from the path <span class="math notranslate nohighlight">\(\ell_i\)</span> of the particle in the volume receiver <a class="reference internal" href="#equation-eq-density-energy-punctual-receiver">(14)</a>.</div>
</div>
<p>The <strong>sound intensity</strong> <span class="math notranslate nohighlight">\(I_\text{rec}^{j}(n)\)</span> (in W/m<span class="math notranslate nohighlight">\(^2\)</span>) at the receiving point is given by:</p>
<div class="math notranslate nohighlight">
\[I_\text{rec}^{j}(n)=c \times w^{j}_\text{rec}(n)= \frac{W}{N} \frac{1}{V_\text{rec}} \sum_i^{N_0} \epsilon_i^{j}\ell_i.\]</div>
<p>The <strong>sound intensity level</strong> <span class="math notranslate nohighlight">\(L_\text{I,rec}^{j}(n)\)</span> and the <strong>sound pressure level</strong> <span class="math notranslate nohighlight">\(SPL_\text{rec}(n)\)</span> (in dB) can then be derived from the sound intensity by the following relationships:</p>
<div class="math notranslate nohighlight">
\[\label{LI_recepteur_volumique}
        L_\text{I,rec}^{j}(n)=10\log\left(\frac{P2_\text{rec}^{j}(n)}{\rho_0 c I_0}\right),\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\label{SPL_recepteur_volumique}
        SPL_\text{rec}^{j}(n)=10\log\left( \frac{P2_\text{rec}^{j}(n)}{p_0^2}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(I_0=10^{-12}\)</span> W/m <span class="math notranslate nohighlight">\(^2\)</span> and <span class="math notranslate nohighlight">\(p_0=20 \times 10^{-6}\)</span> Pa denote the reference sound intensity and sound pressure. Each of the previous quantities (energy, energy density, intensity and sound levels) are calculated for each frequency band.</p>
</div>
<div class="section" id="intensity-vector-at-a-volume-receiver">
<h3>Intensity vector at a volume receiver<a class="headerlink" href="#intensity-vector-at-a-volume-receiver" title="Permalink to this headline">¶</a></h3>
<p>The vector <strong>sound intensity</strong> <span class="math notranslate nohighlight">\(\mathbf{I}_\text{rec}^{j}(n)\)</span> (in W/m <span class="math notranslate nohighlight">\(^2\)</span> or J/m <span class="math notranslate nohighlight">\(^2\)</span>.s) at the receiving point, for the frequency band <span class="math notranslate nohighlight">\(j\)</span>, is defined as the sum of the energy densities carried by the velocity vector <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> of the particles (standard <span class="math notranslate nohighlight">\(c_i\)</span>) passing through the receiving volume:</p>
</div>
<div class="section" id="calculation-of-the-lateral-sound-pressure-level-at-a-volume-receiver">
<h3>Calculation of the lateral sound pressure level at a volume receiver<a class="headerlink" href="#calculation-of-the-lateral-sound-pressure-level-at-a-volume-receiver" title="Permalink to this headline">¶</a></h3>
<p>For the calculation of certain acoustic parameters, such as those based on lateral energy (LF with a weighting in <span class="math notranslate nohighlight">\(|\cos\theta|\)</span> and LFC with a weighting in <span class="math notranslate nohighlight">\(\cos^2\theta\)</span>), it is necessary to consider a weighting of the sound intensity as a function of the angle <span class="math notranslate nohighlight">\(\theta\)</span> between the observation direction of the point receiver (in principle oriented towards the sound source) and the incident direction of the particles at the receiver. As a result, the <strong>SPPS</strong> code also returns the following two quantities, homogeneous to the square of the sound pressure (<em>i.e.</em> in Pa<span class="math notranslate nohighlight">\(^2\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
        P2_{\text{rec},\cos\theta}^{j}(n)&amp;= \rho_0 c^2 \times w^{j}_{\text{rec},\cos\theta}(n)\\
        &amp;= \rho_0 c \frac{W}{N} \frac{1}{V_\text{rec}} \times \sum_i^{N_0} \epsilon_i^{j}\ell_i|\cos\theta_i|,
        \end{aligned}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
         P2_{\text{rec},\cos^2\theta}^{j}(n)&amp;= \rho_0 c^2 \times w^{j}_{\text{rec},\cos^2\theta}\\
         &amp;= \rho_0 c \frac{W}{N} \frac{1}{V_\text{rec}} \times \sum_i^{N_0} \epsilon_i^{j}\ell_i\cos^2\theta_i.
        \end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta_i\)</span> is the corresponding angle for the particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
</div>
<div class="section" id="calculation-of-the-sound-intensity-level-on-a-surface-receiver">
<h3>Calculation of the sound intensity level on a surface receiver<a class="headerlink" href="#calculation-of-the-sound-intensity-level-on-a-surface-receiver" title="Permalink to this headline">¶</a></h3>
<p>The <strong>power</strong> <span class="math notranslate nohighlight">\(W_\text{surf}^{j}\)</span> (in W) received by a surface element of size <span class="math notranslate nohighlight">\(\Delta S\)</span> of normal <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is equal to the sum of the energy provided by each particle <span class="math notranslate nohighlight">\(i\)</span> in the frequency band <span class="math notranslate nohighlight">\(j\)</span> per time unit <span class="math notranslate nohighlight">\(\Delta t\)</span>, at the time step <span class="math notranslate nohighlight">\(n\)</span> (<em>i.e.</em> at time <span class="math notranslate nohighlight">\(n\Delta t\)</span>), either:</p>
<div class="math notranslate nohighlight">
\[W_\text{surf}^{j}(n)=\sum_i^{N_0} \frac{\varepsilon_i^{j}}{\Delta t} \frac{\mathbf{v_i}}{c}\cdot \mathbf{n}=\frac{W}{N} \sum_i^{N_0}  \epsilon_i\cos\theta_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{v_i}\)</span> refers to the velocity vector (of norm <span class="math notranslate nohighlight">\(c\)</span>) of the particle <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(\theta_i\)</span> the angle between normal <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> of the surface and the direction of the particle, and where <span class="math notranslate nohighlight">\({N_0}\)</span> is the total number of sound particles colliding with the surface element <span class="math notranslate nohighlight">\(\Delta S\)</span>.</p>
<p>The <strong>sound intensity</strong> <span class="math notranslate nohighlight">\(I_\text{surf}^{j}(n)\)</span> (in W/m <span class="math notranslate nohighlight">\(^2\)</span>) received by the surface element <span class="math notranslate nohighlight">\(\Delta S\)</span> at the time step <span class="math notranslate nohighlight">\(n\)</span> is equal to the power received divided by the surface, either:</p>
<div class="math notranslate nohighlight">
\[I_\text{surf}^{j}(n)=\frac{W}{N} \frac{1}{\Delta S}\sum_i^{N_0} \epsilon_i^{j} \cos\theta_i.\]</div>
<p>The <strong>sound level</strong> <span class="math notranslate nohighlight">\(L_\text{surf}^{j}(n)\)</span> (in dB) can then be calculated by the following relationship:</p>
<div class="math notranslate nohighlight">
\[\label{L_receiver_surface}
        L_\text{surf}^{j}(n)= 10\log\frac{I_\text{surf}^{j}(n)}{I_0},\]</div>
<p>where <span class="math notranslate nohighlight">\(I_0=10^{-12}\)</span> W/m <span class="math notranslate nohighlight">\(^2\)</span> is the reference intensity.</p>
<div class="figure align-center" id="id64">
<span id="geo-surface-receiver"></span><a class="reference internal image-reference" href="_images/geo_surface_receiver.png"><img alt="Principle of the calculation of the sound intensity level for a surface receiver." src="_images/geo_surface_receiver.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Principle of the calculation of the sound intensity level for a surface receiver</span></p>
</div>
</div>
<div class="section" id="calculation-of-the-sound-pressure-level-on-a-surface-receiver">
<h3>Calculation of the sound pressure level on a surface receiver<a class="headerlink" href="#calculation-of-the-sound-pressure-level-on-a-surface-receiver" title="Permalink to this headline">¶</a></h3>
<p>Equivalent to the calculation of the sound intensity level on a surface receiver, the quadratic sound pressure <span class="math notranslate nohighlight">\(P2_\text{surf}^{j}(n)\)</span> (in Pa) received by the surface element <span class="math notranslate nohighlight">\(\Delta S\)</span> at the time step <span class="math notranslate nohighlight">\(n\)</span> is equal to the product of the sound intensity (without weighting the angle of incidence on the surface) by the characteristic impedance of the air <span class="math notranslate nohighlight">\(\rho_0\)</span> that is:</p>
<div class="math notranslate nohighlight">
\[P2_\text{surf}^{j}(n)=\rho_0\rho_0\, c \frac{W}{N} \frac{1}{\Delta S}\sum_i^{N_0} \epsilon_i^{j}.\]</div>
<p>The <strong>sound pressure level</strong> <span class="math notranslate nohighlight">\(L_\text{SPL,surf}^{j}(n)\)</span> (in dB) can then be calculated by the following relationship:</p>
<div class="math notranslate nohighlight">
\[\label{SPL_receiver_surface}
        L_\text{SPL,surf}^{j}(n)= 10\log\frac{P2_\text{surf}^{j}(n)}{p_0^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(p_0=20\times 10^{-6}\)</span> Pa is the reference sound pressure.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Note that the calculation of a sound pressure level for a surface is quite ambiguous. It should not be comparable to grid of punctual receivers on a plane.</p>
</div>
</div>
<div class="section" id="calculation-of-the-overall-sound-pressure-level-in-the-model">
<h3>Calculation of the overall sound pressure level in the model<a class="headerlink" href="#calculation-of-the-overall-sound-pressure-level-in-the-model" title="Permalink to this headline">¶</a></h3>
<p>The overall sound intensity <span class="math notranslate nohighlight">\(I_\text{global}^{j}(n)\)</span> in the model, for the frequency band <span class="math notranslate nohighlight">\(j\)</span>, is calculated by summing the intensities carried by all the sound particles present <span class="math notranslate nohighlight">\(N_n\)</span> in the model at the time step <span class="math notranslate nohighlight">\(n\)</span> (<em>i.e.</em> at time <span class="math notranslate nohighlight">\(n\delta t\)</span>):</p>
<div class="math notranslate nohighlight">
\[I_\text{global}^{j}(n)= \frac{W}{N} \frac{1}{V_\text{rec}} \sum_i^{N_n} \epsilon_i^{j}\ell_i.\]</div>
<p>The <strong>sound pressure level</strong> <span class="math notranslate nohighlight">\(SPL_\text{global}^{j}(n)\)</span> (in dB) can then be calculated by the following relationship:</p>
<div class="math notranslate nohighlight">
\[\label{SPL_global} SPL_\text{global}^{j}(n)=10\log\left( \frac{P2_\text{global}^{j}(n)}{p_0^2}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(p_0=20\times 10^{-6}\)</span> Pa is the reference sound pressure.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code_TCR.html" class="btn btn-neutral float-right" title="Presentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="code_SPPS_principle.html" class="btn btn-neutral float-left" title="General principle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Ifsttar

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>