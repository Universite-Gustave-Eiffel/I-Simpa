name: build-linux

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-20.04
    strategy:
      matrix:
        python-version: [3.8]
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v2
      with:
        python-version: ${{ matrix.python-version }}
    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y python3.8-dev freeglut3-dev libxmu-dev libxi-dev libpng-dev libjpeg-dev libxxf86vm1 libxxf86vm-dev libxi-dev libxrandr-dev mesa-common-dev mesa-utils libgl1-mesa-dev libglapi-mesa libgtk-3-dev byacc gettext
    - name: Cache directories
      uses: actions/cache@v2
      with:
        path: |
          $HOME/wxWidgets-install
          $HOME/boost-install
          $HOME/swig-install
        key: ${{ runner.os }}-deps-${{ hashFiles('**/requirements.txt') }}
    - name: Before Install
      run: |
        "./ci/travis/${{ runner.os }}/before_install.sh"
    - name: Install
      run: |
        "./ci/travis/${{ runner.os }}/install.sh"
    - name: Before Script
      run: |
        "./ci/travis/${{ runner.os }}/before_script.sh"
    - name: Script
      run: |
        "./ci/travis/${{ runner.os }}/script.sh"
    - name: After Script
      run: |
        "./ci/travis/${{ runner.os }}/after_script.sh"