app-id: org.noise_planet.i-simpa
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
command: ../isimpa
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --filesystem=home
  - --env=LD_LIBRARY_PATH=/app/lib:/app/lib64
modules:
  - name: cpm
    buildsystem: simple
    sources:
      - type: file
        url: https://github.com/cpm-cmake/CPM.cmake/releases/download/v0.40.7/CPM.cmake
        sha256: c0fc82149e00c43a21febe7b2ca57b2ffea2b8e88ab867022c21d6b81937eb50
    build-commands:
      - mkdir -p /app/share/cpm
      - install -m 0644 CPM.cmake /app/share/cpm/CPM_0.40.7.cmake
  - name: boost
    buildsystem: cmake
    sources:
      - type: archive
        url: https://github.com/boostorg/boost/releases/download/boost-1.86.0/boost-1.86.0-cmake.tar.xz
        sha256: 2c5ec5edcdff47ff55e27ed9560b0a0b94b07bd07ed9928b476150e16b0efc57
    config-opts:
      - -DBOOST_ENABLE_CMAKE=ON
      - -DBUILD_TESTING=ON
      - -DBOOST_ENABLE_TEST=ON
      - -DBOOST_ENABLE_PYTHON=ON
      - -DBUILD_SHARED_LIBS=ON
      - -DBOOST_INCLUDE_LIBRARIES=system\;algorithm\;random\;filesystem\;regex\;thread\;chrono\;test\;date_time\;python\;numeric/conversion
      - -DCMAKE_BUILD_TYPE=Release
  - name: swig
    buildsystem: autotools
    sources:
      - type: archive
        url: https://downloads.sourceforge.net/project/swig/swig/swig-4.1.1/swig-4.1.1.tar.gz
        sha256: 2af08aced8fcd65cdb5cc62426768914bedc735b1c250325203716f78e39ac9b
    config-opts:
      - --without-maximum-compile-warnings
      - --without-pcre
  - name: glu
    buildsystem: meson
    sources:
      - type: archive
        url: https://gitlab.freedesktop.org/mesa/glu/-/archive/glu-9.0.3/glu-glu-9.0.3.tar.gz
        sha256: 7e919cbc1b2677b01d65fc28fd36a19d1f3e23d76663020e0f3b82b991475e8b
    post-install:
      - ln -sf /app/lib64/libGLU.so.1 /app/lib/libGLU.so.1
  - name: wxwidgets
    buildsystem: cmake
    config-opts:
      - -DwxBUILD_SHARED=ON
      - -DwxUSE_OPENGL=ON
      - -DwxUSE_GLCANVAS_EGL=OFF
      - -DwxUSE_UNICODE=ON
    sources:
      - type: archive
        url: https://github.com/wxWidgets/wxWidgets/releases/download/v3.2.8.1/wxWidgets-3.2.8.1.tar.bz2
        sha256: ad0cf6c18815dcf1a6a89ad3c3d21a306cd7b5d99a602f77372ef1d92cb7d756
  - name: isimpa
    buildsystem: cmake-ninja
    sources:
      - type: dir
        path: src
        dest: src
      - type: dir
        path: currentRelease
        dest: currentRelease
      - type: dir
        path: cmake
        dest: cmake
      - type: file
        path: CMakeLists.txt
      - type: file
        path: DESCRIPTION.txt
      - type: file
        path: LICENSE.md
      - type: file
        path: org.noise_planet.i-simpa.desktop
      - type: file
        path: org.noise_planet.i-simpa.appdata.xml
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCPM_SOURCE_CACHE=/app/share
      - -DBoost_DIR=/app/lib64/cmake/Boost-1.86.0
      - -DBOOST_ROOT=/app
